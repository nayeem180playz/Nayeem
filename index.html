<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EarnWalk - Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    /* Common Styles */
    .container {
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .form-container {
      padding: 30px;
    }

    .title {
      text-align: center;
      margin-bottom: 20px;
      color: #333;
      font-size: 24px;
      font-weight: 600;
    }

    .input-group {
      margin-bottom: 15px;
    }

    .input-group label {
      display: block;
      margin-bottom: 5px;
      font-size: 14px;
      color: #555;
    }

    .input-group input, .input-group select, .input-group textarea {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.3s;
    }

    .input-group input:focus, .input-group select:focus, .input-group textarea:focus {
      border-color: #8e2de2;
      outline: none;
    }

    .btn {
      width: 100%;
      padding: 12px;
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      margin-top: 10px;
    }

    .btn:hover {
      opacity: 0.9;
      transform: translateY(-2px);
    }

    .toggle-form {
      text-align: center;
      margin-top: 20px;
      font-size: 14px;
      color: #555;
    }

    .toggle-form a {
      color: #8e2de2;
      text-decoration: none;
      font-weight: 500;
    }

    .error-message {
      color: #ff4757;
      font-size: 13px;
      margin-top: 5px;
      text-align: center;
    }

    .success-message {
      color: #2ed573;
      font-size: 13px;
      margin-top: 5px;
      text-align: center;
    }

    /* Pending Approval Styles */
    .pending-container {
      padding: 30px;
      text-align: center;
    }

    .pending-title {
      color: #8e2de2;
      font-size: 22px;
      margin-bottom: 20px;
    }

    .pending-message {
      background: #f8f8f8;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      font-size: 14px;
      color: #555;
      line-height: 1.6;
    }

    .contact-info {
      margin-top: 30px;
      font-size: 14px;
      color: #555;
    }

    .contact-info a {
      color: #8e2de2;
      text-decoration: none;
    }

    /* Dashboard Styles */
    .dashboard-container {
      display: none;
      width: 100%;
      max-width: 500px;
      margin: 20px 0;
    }

    .header {
      background: white;
      padding: 15px;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      border-radius: 15px;
      margin-bottom: 20px;
    }

    .username {
      font-size: 18px;
      font-weight: 600;
      color: #333;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      padding: 0 20px 20px;
    }

    .card {
      background: white;
      border-radius: 10px;
      padding: 15px 5px;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
      opacity: 0;
      transform: translateY(50px);
      animation: fadeInUp 0.6s forwards;
    }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card:nth-child(1) { animation-delay: 0.1s; }
    .card:nth-child(2) { animation-delay: 0.2s; }
    .card:nth-child(3) { animation-delay: 0.3s; }
    .card:nth-child(4) { animation-delay: 0.4s; }
    .card:nth-child(5) { animation-delay: 0.5s; }
    .card:nth-child(6) { animation-delay: 0.6s; }
    .card:nth-child(7) { animation-delay: 0.7s; }
    .card:nth-child(8) { animation-delay: 0.8s; }
    .card:nth-child(9) { animation-delay: 0.9s; }
    .card:nth-child(10){ animation-delay: 1s; }
    .card:nth-child(11){ animation-delay: 1.1s; }
    .card:nth-child(12){ animation-delay: 1.2s; }

    .card:hover {
      transform: scale(1.05);
    }

    .card img {
      width: 39px;
      height: 39px;
    }

    .card p {
      margin: 9px 0 0;
      font-weight: bold;
      font-size: 15px;
    }

    .logout-btn {
      background: #ff4757;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      margin: 20px auto;
      display: block;
      font-size: 16px;
      font-weight: 500;
      transition: all 0.3s;
    }

    .logout-btn:hover {
      opacity: 0.9;
    }

    /* Admin Panel Styles */
    .admin-dashboard {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .admin-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .admin-title {
      font-size: 20px;
      font-weight: 600;
    }

    .admin-nav {
      display: flex;
      background: #f8f8f8;
      border-bottom: 1px solid #eee;
      overflow-x: auto;
      white-space: nowrap;
    }

    .admin-nav-item {
      padding: 15px 20px;
      cursor: pointer;
      font-weight: 500;
      color: #555;
      border-bottom: 3px solid transparent;
      transition: all 0.3s;
    }

    .admin-nav-item.active {
      color: #8e2de2;
      border-bottom-color: #8e2de2;
      background: #fff;
    }

    .admin-content {
      padding: 20px;
      min-height: 300px;
    }

    .admin-section {
      display: none;
    }

    .admin-section.active {
      display: block;
    }

    .user-list {
      margin-top: 20px;
    }

    .user-card {
      background: #f8f8f8;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }

    .user-info {
      flex: 1;
      min-width: 200px;
    }

    .user-name {
      font-weight: 600;
    }

    .user-email {
      font-size: 12px;
      color: #555;
    }

    .user-status {
      font-size: 12px;
      padding: 3px 8px;
      border-radius: 10px;
      background: #ddd;
      color: #333;
    }

    .user-status.pending {
      background: #ffa502;
      color: white;
    }

    .user-status.approved {
      background: #2ed573;
      color: white;
    }

    .user-status.rejected {
      background: #ff4757;
      color: white;
    }

    .action-buttons {
      display: flex;
      gap: 5px;
      margin-top: 10px;
    }

    .action-btn {
      padding: 8px 12px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      transition: all 0.3s;
    }

    .approve-btn {
      background: #2ed573;
      color: white;
    }

    .reject-btn {
      background: #ff4757;
      color: white;
    }

    .view-btn {
      background: #3498db;
      color: white;
    }

    .stats-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }

    .stat-card {
      background: #f8f8f8;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
    }

    .stat-value {
      font-size: 24px;
      font-weight: 600;
      color: #8e2de2;
    }

    .stat-label {
      font-size: 14px;
      color: #555;
    }

    /* Work Menu Styles */
    .work-menu-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .work-menu-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .work-menu-content {
      padding: 15px;
      max-height: 500px;
      overflow-y: auto;
    }

    .menu-item {
      background: #d4e9ff;
      margin: 10px 0;
      padding: 10px 15px;
      border-radius: 30px;
      color: #333;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      transform: translateX(-20px);
      opacity: 0;
      animation: slideIn 0.5s forwards;
    }

    @keyframes slideIn {
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .menu-item:nth-child(1) { animation-delay: 0.1s; }
    .menu-item:nth-child(2) { animation-delay: 0.2s; }
    .menu-item:nth-child(3) { animation-delay: 0.3s; }
    .menu-item:nth-child(4) { animation-delay: 0.4s; }
    .menu-item:nth-child(5) { animation-delay: 0.5s; }
    .menu-item:nth-child(6) { animation-delay: 0.6s; }
    .menu-item:nth-child(7) { animation-delay: 0.7s; }
    .menu-item:nth-child(8) { animation-delay: 0.8s; }
    .menu-item:nth-child(9) { animation-delay: 0.9s; }
    .menu-item:nth-child(10) { animation-delay: 1.0s; }

    .menu-item:hover {
      background: #a7ccff;
      transition: 0.3s;
    }

    .menu-icon {
      color: #ff2fbf;
    }

    .back-btn {
      background: #3498db;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 15px;
      font-weight: 500;
      transition: all 0.3s;
    }

    .back-btn:hover {
      opacity: 0.9;
    }

    /* Help Line Styles */
    .help-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .help-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .help-content {
      padding: 20px;
      background: linear-gradient(to bottom right, #ff2fbf, #8e2de2);
      color: white;
      text-align: center;
    }

    .help-box {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 19px;
      width: 100%;
      text-align: center;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
      animation: fadeIn 1s ease forwards;
      opacity: 0;
      transform: translateY(30px);
    }

    @keyframes fadeIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .help-content h2 {
      margin-bottom: 20px;
      font-size: 24px;
    }

    .link-button {
      display: block;
      background: #fff;
      color: #8e2de2;
      margin: 10px 0;
      padding: 12px 20px;
      border-radius: 30px;
      text-decoration: none;
      font-weight: bold;
      transition: all 0.3s;
    }

    .link-button:hover {
      background: #8e2de2;
      color: #fff;
      transform: scale(1.05);
    }

    .whatsapp {
      margin-top: 20px;
      font-size: 18px;
    }

    .whatsapp span {
      display: inline-block;
      animation: pulse 1s infinite alternate;
    }

    @keyframes pulse {
      from { transform: scale(1); }
      to { transform: scale(1.1); color: #00ffcc; }
    }

    .name-link {
      margin-top: 10px;
      font-size: 20px;
      font-weight: bold;
      color: #fff;
      text-decoration: none;
      transition: color 0.3s ease;
      display: block;
    }

    .name-link:hover {
      color: #000;
      text-decoration: underline;
    }

    /* Profile Level Styles */
    .profile-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .profile-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .profile-content {
      padding: 20px;
    }

    .level-container {
      text-align: center;
      margin-bottom: 20px;
    }

    .level-display {
      font-size: 24px;
      font-weight: bold;
      color: #8e2de2;
      margin-bottom: 10px;
    }

    .points-display {
      font-size: 18px;
      color: #555;
      margin-bottom: 20px;
    }

    .progress-container {
      width: 100%;
      height: 20px;
      background: #f0f0f0;
      border-radius: 10px;
      margin-bottom: 20px;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      border-radius: 10px;
      transition: width 0.5s ease;
    }

    .level-rewards {
      margin-top: 20px;
    }

    .reward-item {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      padding: 10px;
      background: #f8f8f8;
      border-radius: 8px;
    }

    .reward-icon {
      width: 30px;
      height: 30px;
      margin-right: 10px;
      color: #8e2de2;
    }

    .reward-text {
      flex: 1;
      font-size: 14px;
    }

    .reward-achieved {
      color: #2ed573;
      font-weight: bold;
    }

    /* Referral Styles */
    .referral-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .referral-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .referral-content {
      padding: 20px;
    }

    .referral-code-box {
      background: #f8f8f8;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      margin-bottom: 20px;
    }

    .referral-code {
      font-size: 24px;
      font-weight: bold;
      color: #8e2de2;
      margin: 10px 0;
    }

    .copy-btn {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s;
      margin-top: 10px;
    }

    .copy-btn:hover {
      opacity: 0.9;
    }

    .referral-stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }

    .stat-box {
      background: #f8f8f8;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
    }

    .stat-value {
      font-size: 20px;
      font-weight: bold;
      color: #8e2de2;
    }

    .stat-label {
      font-size: 14px;
      color: #555;
    }

    .referral-link {
      margin-top: 20px;
      padding: 15px;
      background: #f0f0f0;
      border-radius: 10px;
      word-break: break-all;
    }

    .history-container {
      margin-top: 20px;
      max-height: 300px;
      overflow-y: auto;
    }

    .history-item {
      background: #f8f8f8;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 10px;
      font-size: 14px;
    }

    .history-item .date {
      font-size: 12px;
      color: #777;
      margin-top: 5px;
    }

    /* History Styles */
    .history-container-full {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .history-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .history-content {
      padding: 20px;
      max-height: 500px;
      overflow-y: auto;
    }

    .history-list {
      margin-top: 15px;
    }

    .history-entry {
      background: #f8f8f8;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .history-type {
      font-weight: bold;
      color: #8e2de2;
    }

    .history-details {
      margin-top: 5px;
      font-size: 14px;
    }

    .history-date {
      font-size: 12px;
      color: #777;
      margin-top: 5px;
      text-align: right;
    }

    /* Notice Board Styles */
    .notice-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .notice-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .notice-content {
      padding: 20px;
      background: linear-gradient(to bottom right, #ff2fbf, #8e2de2);
      color: white;
      text-align: center;
    }

    .notice-box {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 19px;
      width: 100%;
      text-align: left;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
      animation: fadeIn 1s ease forwards;
      opacity: 0;
      transform: translateY(30px);
    }

    .notice-box h2 {
      text-align: center;
      margin-bottom: 15px;
    }

    .notice-box p {
      margin-bottom: 10px;
      line-height: 1.5;
    }

    /* Offer Page Styles */
    .offer-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .offer-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .offer-content {
      padding: 20px;
      background: linear-gradient(to bottom right, #ff2fbf, #8e2de2);
      color: white;
      text-align: center;
    }

    .offer-box {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 19px;
      width: 100%;
      text-align: center;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
      animation: fadeIn 1s ease forwards;
      opacity: 0;
      transform: translateY(30px);
    }

    .offer-box h2 {
      margin-bottom: 20px;
      font-size: 24px;
    }

    .offer-box p {
      margin-bottom: 15px;
      line-height: 1.5;
      text-align: left;
    }

    /* Leaderboard Styles */
    .leaderboard-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .leaderboard-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .leaderboard-content {
      padding: 20px;
    }

    .leaderboard-list {
      margin-top: 15px;
      max-height: 500px;
      overflow-y: auto;
    }

    .leaderboard-item {
      display: flex;
      align-items: center;
      padding: 12px;
      background: #f8f8f8;
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .leaderboard-rank {
      width: 30px;
      height: 30px;
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      margin-right: 15px;
    }

    .leaderboard-user {
      flex: 1;
    }

    .leaderboard-name {
      font-weight: bold;
    }

    .leaderboard-points {
      font-size: 14px;
      color: #555;
    }

    /* Balance Page Styles */
    .balance-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .balance-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .balance-content {
      padding: 20px;
    }

    .balance-display {
      background: #f8f8f8;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      margin-bottom: 20px;
    }

    .balance-amount {
      font-size: 32px;
      font-weight: bold;
      color: #8e2de2;
      margin: 10px 0;
    }

    .points-display-balance {
      font-size: 24px;
      color: #555;
      margin-bottom: 20px;
    }

    .convert-btn {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      border: none;
      padding: 12px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: all 0.3s;
    }

    .convert-btn:hover {
      opacity: 0.9;
    }

    .convert-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    /* Withdraw Page Styles */
    .withdraw-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .withdraw-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .withdraw-content {
      padding: 20px;
    }

    .balance-display-withdraw {
      background: #f8f8f8;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      margin-bottom: 20px;
    }

    .withdraw-message {
      background: #f8f8f8;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      font-size: 14px;
      color: #555;
      line-height: 1.6;
      display: none;
    }

    .withdraw-form {
      margin-top: 20px;
    }

    .withdraw-btn {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      border: none;
      padding: 12px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: all 0.3s;
    }

    .withdraw-btn:hover {
      opacity: 0.9;
    }

    .withdraw-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    /* Screenshot Page Styles */
    .screenshot-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .screenshot-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .screenshot-content {
      padding: 20px;
    }

    .screenshot-form {
      margin-bottom: 20px;
    }

    .screenshot-list {
      margin-top: 20px;
      max-height: 400px;
      overflow-y: auto;
    }

    .screenshot-item {
      background: #f8f8f8;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      position: relative;
    }

    .screenshot-image {
      width: 100%;
      border-radius: 5px;
      margin-bottom: 10px;
    }

    .screenshot-status {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 3px 8px;
      border-radius: 10px;
      font-size: 12px;
      font-weight: bold;
    }

    .status-pending {
      background: #ffa502;
      color: white;
    }

    .status-approved {
      background: #2ed573;
      color: white;
    }

    .status-rejected {
      background: #ff4757;
      color: white;
    }

    .screenshot-date {
      font-size: 12px;
      color: #777;
      margin-top: 5px;
    }

    .add-screenshot-btn {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      border: none;
      padding: 10px;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 24px;
      cursor: pointer;
      position: fixed;
      bottom: 30px;
      right: 30px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      transition: all 0.3s;
    }

    .add-screenshot-btn:hover {
      transform: scale(1.1);
    }

    /* Admin Screenshot Styles */
    .screenshot-admin-item {
      background: #f8f8f8;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
    }

    .screenshot-admin-image {
      width: 100%;
      border-radius: 5px;
      margin-bottom: 10px;
    }

    .screenshot-admin-info {
      margin-bottom: 10px;
    }

    .screenshot-admin-user {
      font-weight: bold;
    }

    /* User Details Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 500px;
      max-height: 80vh;
      overflow-y: auto;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .modal-title {
      font-size: 20px;
      font-weight: bold;
      color: #8e2de2;
    }

    .close-modal {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #555;
    }

    .modal-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
    }

    .modal-action-btn {
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s;
    }

    .delete-btn {
      background: #ff4757;
      color: white;
    }

    .add-points-btn {
      background: #2ed573;
      color: white;
    }

    .remove-points-btn {
      background: #ffa502;
      color: white;
    }

    .add-bdt-btn {
      background: #3498db;
      color: white;
    }

    .points-input {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }

    /* Responsive Styles */
    @media (max-width: 500px) {
      .grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .stats-container {
        grid-template-columns: 1fr;
      }
      
      .admin-nav {
        flex-wrap: wrap;
      }
      
      .admin-nav-item {
        padding: 10px 15px;
        font-size: 14px;
      }
      
      .user-card {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .action-buttons {
        align-self: flex-end;
      }

      .menu-item {
        padding: 12px 15px;
        font-size: 14px;
      }

      .referral-stats {
        grid-template-columns: 1fr;
      }

      .modal-actions {
        flex-direction: column;
      }

      .modal-action-btn {
        width: 100%;
      }

      .add-screenshot-btn {
        bottom: 20px;
        right: 20px;
      }
    }

    @media (max-width: 350px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Login Container -->
  <div class="container" id="loginContainer">
    <div class="form-container">
      <h2 class="title">Login</h2>
      <div id="loginError" class="error-message"></div>
      <div class="input-group">
        <label for="loginEmail">Email</label>
        <input type="email" id="loginEmail" placeholder="Enter your email">
      </div>
      <div class="input-group">
        <label for="loginPassword">Password</label>
        <input type="password" id="loginPassword" placeholder="Enter your password">
      </div>
      <button class="btn" id="loginBtn">Login</button>
      <div class="toggle-form">
        Don't have an account? <a href="#" id="showRegister">Register</a>
      </div>
    </div>
  </div>

  <!-- Registration Container -->
  <div class="container" id="registerContainer" style="display: none;">
    <div class="form-container">
      <h2 class="title">Registration</h2>
      <div id="registerError" class="error-message"></div>
      <div id="registerSuccess" class="success-message"></div>
      
      <div class="input-group">
        <label for="username">Username</label>
        <input type="text" id="username" placeholder="Enter username">
      </div>
      
      <div class="input-group">
        <label for="name">Name</label>
        <input type="text" id="name" placeholder="Enter your full name">
      </div>
      
      <div class="input-group">
        <label for="gender">Choose Your Gender</label>
        <select id="gender">
          <option value="">Select Gender</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Other">Other</option>
        </select>
      </div>
      
      <div class="input-group">
        <label for="education">Choose Your Education</label>
        <select id="education">
          <option value="">Select Education</option>
          <option value="JSC">JSC</option>
          <option value="SSC">SSC</option>
          <option value="HSC">HSC</option>
          <option value="BSc">BSc</option>
          <option value="MSc">MSc</option>
          <option value="NONE">NONE</option>
        </select>
      </div>
      
      <div class="input-group">
        <label for="email">Email</label>
        <input type="email" id="email" placeholder="Enter your email">
      </div>
      
      <div class="input-group">
        <label for="password">Password</label>
        <input type="password" id="password" placeholder="Create a password">
      </div>
      
      <div class="input-group">
        <label for="whatsapp">WhatsApp Number</label>
        <input type="text" id="whatsapp" placeholder="Enter WhatsApp number">
      </div>
      
      <div class="input-group">
        <label for="referral">Referral Code (Optional)</label>
        <input type="text" id="referral" placeholder="Enter referral code if any">
      </div>
      
      <div class="input-group">
        <label for="paymentMethod">Choose Your payment method</label>
        <select id="paymentMethod">
          <option value="">Select Payment Method</option>
          <option value="Bkash">Bkash</option>
          <option value="Nagad">Nagad</option>
          <option value="Rocket">Rocket</option>
          <option value="Upay">Upay</option>
          <option value="Others">Others</option>
        </select>
      </div>
      
      <div class="input-group">
        <label for="paymentNumber">Payment Number (11 digits)</label>
        <input type="text" id="paymentNumber" placeholder="Enter payment number">
      </div>
      
      <div class="input-group">
        <label for="transactionId">Transaction ID (TrixId)</label>
        <input type="text" id="transactionId" placeholder="Enter transaction ID">
      </div>
      
      <div class="input-group">
        <label for="datetime">Date and Time</label>
        <input type="datetime-local" id="datetime">
      </div>
      
      <div class="input-group" style="display: flex; align-items: center;">
        <input type="checkbox" id="agreeTerms" style="width: auto; margin-right: 10px;">
        <label for="agreeTerms" style="margin-bottom: 0;">I agree to the terms and conditions</label>
      </div>
      
      <button class="btn" id="registerBtn">Register</button>
      <div class="toggle-form">
        Already have an account? <a href="#" id="showLogin">Login</a>
      </div>
    </div>
  </div>

  <!-- Pending Approval Container -->
  <div class="container" id="pendingContainer" style="display: none;">
    <div class="pending-container">
      <h2 class="pending-title">Pending Request</h2>
      <div class="pending-message">
        Please wait while admin reviews your registration request. Admin will approve your request within 24 hours. If you face any issues, please contact admin via WhatsApp using the number below.
      </div>
      <div class="contact-info">
        Contact Admin: <a href="https://wa.me/1234567890">WhatsApp</a>
      </div>
    </div>
  </div>

  <!-- Dashboard Container -->
  <div class="dashboard-container" id="dashboardContainer" style="display: none;">
    <div class="header">
      <div class="username" id="dashboardUsername">Welcome, User</div>
    </div>
    <div class="grid">
      <a href="#" class="card" id="profileCard">
        <img src="https://img.icons8.com/ios/50/checked-user-male.png" alt="Profile">
        <p>Profile Level</p>
      </a>

      <a href="#" class="card" id="workCard">
        <img src="https://img.icons8.com/ios/50/briefcase.png" alt="Work">
        <p>My Work</p>
      </a>

      <a href="#" class="card" id="helpCard">
        <img src="https://img.icons8.com/ios/50/help.png" alt="Help">
        <p>Help Line</p>
      </a>

      <a href="#" class="card" id="referCard">
        <img src="https://img.icons8.com/ios/50/share.png" alt="Refer">
        <p>Refer</p>
      </a>

      <a href="#" class="card" id="withdrawCard">
        <img src="https://img.icons8.com/ios/50/money.png" alt="Withdraw">
        <p>Withdraw</p>
      </a>

      <a href="#" class="card" id="screenshotCard">
        <img src="https://img.icons8.com/ios/50/image.png" alt="Screenshot">
        <p>Screenshot</p>
      </a>

      <a href="#" class="card" id="offerCard">
        <img src="https://img.icons8.com/ios/50/email-open.png" alt="Offer">
        <p>Offer</p>
      </a>

      <a href="#" class="card" id="historyCard">
        <img src="https://img.icons8.com/ios/50/time-machine.png" alt="History">
        <p>History</p>
      </a>

      <a href="#" class="card" id="balanceCard">
        <img src="https://img.icons8.com/ios/50/money-bag.png" alt="Balance">
        <p>Balance</p>
      </a>

      <a href="#" class="card" id="leaderboardCard">
        <img src="https://img.icons8.com/ios/50/trophy.png" alt="Leaderboard">
        <p>Leaderboard</p>
      </a>

      <a href="#" class="card" id="noticeCard">
        <img src="https://img.icons8.com/ios/50/megaphone.png" alt="Notice">
        <p>Notice Board</p>
      </a>

      <a href="#" class="card" id="noticeCard2">
        <img src="https://img.icons8.com/ios/50/megaphone.png" alt="Notice 2">
        <p>Notice Board</p>
      </a>
    </div>
    <button class="logout-btn" id="logoutBtn">Logout</button>
  </div>

  <!-- Work Menu Container -->
  <div class="work-menu-container" id="workMenuContainer">
    <div class="work-menu-header">
      My Work Menu
    </div>
    <div class="work-menu-content">
      <div class="menu-item"><span class="menu-icon">??</span>1. Tiktok Like Follow</div>
      <div class="menu-item"><span class="menu-icon">??</span>2. Gmail Work</div>
      <div class="menu-item"><span class="menu-icon">??</span>3. Facebook Work</div>
      <div class="menu-item"><span class="menu-icon">??</span>4. Refer Generation</div>
      <div class="menu-item"><span class="menu-icon">??</span>5. Typing</div>
      <div class="menu-item"><span class="menu-icon">??</span>6. Watch Video</div>
      <div class="menu-item"><span class="menu-icon">??</span>7. VK Surfing</div>
      <div class="menu-item"><span class="menu-icon">??</span>8. Getlike Work</div>
      <div class="menu-item"><span class="menu-icon">??</span>9. Website Visit Work</div>
      <div class="menu-item"><span class="menu-icon">??</span>10. Seleary</div>
    </div>
    <button class="back-btn" id="backToDashboardBtn">Back to Dashboard</button>
  </div>

  <!-- Help Line Container -->
  <div class="help-container" id="helpContainer">
    <div class="help-header">
      Help Line
    </div>
    <div class="help-content">
      <div class="help-box">
        <h2>?? Help Line</h2>
        <p>???? ????? ????? ????? ????? ???</p>
        <a href="https://chat.whatsapp.com/yourgroup" class="link-button" target="_blank">Join WhatsApp Group</a>

        <br/>
        <h1>??Tainner</h1>

        <!-- ? ??? ? ????? ???? WhatsApp ???? ??? -->
        <a href="https://wa.me/8801XXXXXXXXX" target="_blank" class="name-link">
          Mahi chy
        </a>
        
        <br/>
        <!-- ? ??? ? ????? ???? WhatsApp ???? ??? -->
        <a href="https://wa.me/8801XXXXXXXXX" target="_blank" class="name-link">
          Rahim chy
        </a>
      </div>
      <button class="back-btn" id="backToDashboardFromHelpBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- Profile Level Container -->
  <div class="profile-container" id="profileContainer">
    <div class="profile-header">
      Profile Level
    </div>
    <div class="profile-content">
      <div class="level-container">
        <div class="level-display" id="levelDisplay">Level 1</div>
        <div class="points-display" id="pointsDisplay">0 Points</div>
        <div class="progress-container">
          <div class="progress-bar" id="progressBar" style="width: 0%"></div>
        </div>
      </div>
      
      <div class="level-rewards">
        <h3>Level Rewards</h3>
        <div class="reward-item">
          <div class="reward-icon">??</div>
          <div class="reward-text">Level 1: Reach 200 points (Gift: T-Shirt)</div>
          <div class="reward-achieved" id="level1Reward">?</div>
        </div>
        <div class="reward-item">
          <div class="reward-icon">??</div>
          <div class="reward-text">Level 2: Reach 500 points (Gift: T-Shirt + Crest)</div>
          <div class="reward-achieved" id="level2Reward">?</div>
        </div>
        <div class="reward-item">
          <div class="reward-icon">??</div>
          <div class="reward-text">Level 3: Reach 1000 points (Gift: Attractive Gift + T-Shirt + Crest)</div>
          <div class="reward-achieved" id="level3Reward">?</div>
        </div>
        <div class="reward-item">
          <div class="reward-icon">??</div>
          <div class="reward-text">Level 4: Reach 2000 points (Gift: Attractive Gift + Crest)</div>
          <div class="reward-achieved" id="level4Reward">?</div>
        </div>
        <div class="reward-item">
          <div class="reward-icon">??</div>
          <div class="reward-text">Level 5: Reach 4000 points (Gift: Special Gift + Crest)</div>
          <div class="reward-achieved" id="level5Reward">?</div>
        </div>
      </div>
      
      <button class="back-btn" id="backToDashboardFromProfileBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- Referral Container -->
  <div class="referral-container" id="referralContainer">
    <div class="referral-header">
      Referral Program
    </div>
    <div class="referral-content">
      <div class="referral-code-box">
        <p>Your Referral Code</p>
        <div class="referral-code" id="referralCodeDisplay">Loading...</div>
        <button class="copy-btn" id="copyReferralBtn">Copy Code</button>
      </div>
      
      <div class="referral-stats">
        <div class="stat-box">
          <div class="stat-value" id="totalReferrals">0</div>
          <div class="stat-label">Total Referrals</div>
        </div>
        <div class="stat-box">
          <div class="stat-value" id="referralPoints">0</div>
          <div class="stat-label">Points Earned</div>
        </div>
      </div>
      
      <div>
        <p>Your Referral Link:</p>
        <div class="referral-link" id="referralLink">Loading...</div>
      </div>
      
      <div class="history-container">
        <h3>Recent Referral Activity</h3>
        <div id="referralHistoryList">
          <!-- Referral history will be populated here -->
        </div>
      </div>
      
      <button class="back-btn" id="backToDashboardFromReferralBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- Balance Container -->
  <div class="balance-container" id="balanceContainer">
    <div class="balance-header">
      My Balance
    </div>
    <div class="balance-content">
      <div class="balance-display">
        <p>Available Balance</p>
        <div class="balance-amount" id="balanceAmount">0 BDT</div>
        <div class="points-display-balance" id="pointsDisplayBalance">0 Points</div>
      </div>
      
      <button class="convert-btn" id="convertBtn" disabled>Convert Points to BDT (500 Points = 150 BDT)</button>
      
      <button class="back-btn" id="backToDashboardFromBalanceBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- Withdraw Container -->
  <div class="withdraw-container" id="withdrawContainer">
    <div class="withdraw-header">
      Withdraw Money
    </div>
    <div class="withdraw-content">
      <div class="balance-display-withdraw">
        <p>Available Balance</p>
        <div class="balance-amount" id="withdrawBalanceAmount">0 BDT</div>
      </div>
      
      <div class="withdraw-message" id="withdrawMessage">
        Your withdraw request is pending. Admin will process it within 24 hours.
      </div>
      
      <div class="withdraw-form" id="withdrawForm">
        <div class="input-group">
          <label for="withdrawMethod">Withdraw Method</label>
          <select id="withdrawMethod">
            <option value="">Select Method</option>
            <option value="Bkash">Bkash</option>
            <option value="Nagad">Nagad</option>
            <option value="Rocket">Rocket</option>
          </select>
        </div>
        
        <div class="input-group">
          <label for="withdrawNumber">Account Number</label>
          <input type="text" id="withdrawNumber" placeholder="Enter your account number">
        </div>
        
        <button class="withdraw-btn" id="withdrawBtn">Withdraw 150 BDT</button>
      </div>
      
      <button class="back-btn" id="backToDashboardFromWithdrawBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- History Container -->
  <div class="history-container-full" id="historyContainer">
    <div class="history-header">
      My History
    </div>
    <div class="history-content">
      <div class="history-list" id="historyList">
        <!-- History items will be populated here -->
      </div>
      <button class="back-btn" id="backToDashboardFromHistoryBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- Notice Board Container -->
  <div class="notice-container" id="noticeContainer">
    <div class="notice-header">
      Notice Board
    </div>
    <div class="notice-content">
      <div class="notice-box">
        <h2>Level 1</h2>
        <p>????? ????? ??? ???? ???? ???? ??? ????? ???? ?????? ??????? ????? ???? ????? ??? ??? ??? ????? ???? ???????? ??? ???....!!?</p>
        <p>?? ???????????  ?????/ ????? ??? ????? ?????????????? ???? ????? ??????? ???? ????? ???? ????? ??? ????</p>
        <p>?? ?? ??????? ???? ??????? ?? ????????? ???? ????? ????? ??,,??? ????? ??? ????? ????? ???? ????? ??? ????</p> 
        <p>?????????? ????? ?? ?? ????? ???? ????? ????? ?? : Hii, Hello,Hlw, Admin achen, apni ki achen vaiya,,, ??? ????? ????? ???? ???</p>
        <p>??  ?????? ?? ????? ???? ????? ??? ?????? ???? ??????,, ???? ??? ?????? ??? ????? ???? ???? ??????????? ?? ???????,,? ???? ????? ? ???? ???? ??? ????? ???</p>
        <p>?? ?????? ?????? ??? ?????? ???? ???? ?????? ????? ??? ?? ???? ??????? ?? ????? ???? ???? ????? ???? ???????? ??? ????</p>
        <p>????? ????? ??? ???? ???? ???? ???? ?????? ???????*</p>
      </div>
      <button class="back-btn" id="backToDashboardFromNoticeBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- Offer Container -->
  <div class="offer-container" id="offerContainer">
    <div class="offer-header">
      Special Offers
    </div>
    <div class="offer-content">
      <div class="offer-box">
        <h2>Level 1</h2>
        <p>???? ??? ??? ?? ????? ???? ????? ????? ?????? ?????? ?????? ???? ???? ???? ?????? ???? ??? ????</p>
        
        <h2>Level 2</h2>
        <p>???? ??? ??? ?? ????? ???? ????? ????? ?????? ?????? ???? ???? ???? ???? ??? ??? ???? ???? ??????? ?????</p>
        
        <h2>Level 3</h2>
        <p>???? ??? ?????? ????? ????? ????? ???? ????? ????? ????? ???? ???????? ???? ???? ???? ?????? ???? ???? ??????? ?????</p>
        
        <h2>Level 4</h2>
        <p>???? ??? ?????? ????? ????? ????? ???? ????? ????? ?????? ???? ???? ???? ???????? ???? ?? ???? ???? ??????? ?????</p>
        
        <h2>Level 5</h2>
        <p>???? ??? ?????? ????? ???? ?? ????? ???? ????? ????? ?????? ???? ???? ???? ???????? ???? ???? ????? ???? ???? ??????? ??????</p>
      </div>
      <button class="back-btn" id="backToDashboardFromOfferBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- Leaderboard Container -->
  <div class="leaderboard-container" id="leaderboardContainer">
    <div class="leaderboard-header">
      Leaderboard
    </div>
    <div class="leaderboard-content">
      <div class="leaderboard-list" id="leaderboardList">
        <!-- Leaderboard items will be populated here -->
      </div>
      <button class="back-btn" id="backToDashboardFromLeaderboardBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- Screenshot Container -->
  <div class="screenshot-container" id="screenshotContainer">
    <div class="screenshot-header">
      Screenshots
    </div>
    <div class="screenshot-content">
      <div class="screenshot-form" id="screenshotForm" style="display: none;">
        <div class="input-group">
          <label for="screenshotLink">Image URL</label>
          <input type="text" id="screenshotLink" placeholder="Enter image URL">
        </div>
        <div class="input-group">
          <label for="screenshotDescription">Description (Optional)</label>
          <textarea id="screenshotDescription" placeholder="Enter description"></textarea>
        </div>
        <button class="btn" id="submitScreenshotBtn">Submit Screenshot</button>
      </div>
      <div class="screenshot-list" id="screenshotList">
        <!-- Screenshots will be populated here -->
      </div>
      <button class="back-btn" id="backToDashboardFromScreenshotBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- Add Screenshot Button -->
  <button class="add-screenshot-btn" id="addScreenshotBtn" style="display: none;">+</button>

  <!-- Admin Dashboard -->
  <div class="admin-dashboard" id="adminDashboard" style="display: none;">
    <div class="admin-header">
      <div class="admin-title">Admin Panel</div>
      <button class="logout-btn" id="adminLogoutBtn">Logout</button>
    </div>
    
    <div class="admin-nav">
      <div class="admin-nav-item active" data-section="dashboard">Dashboard</div>
      <div class="admin-nav-item" data-section="pending">Pending Requests</div>
      <div class="admin-nav-item" data-section="approved">Approved Users</div>
      <div class="admin-nav-item" data-section="rejected">Rejected Users</div>
      <div class="admin-nav-item" data-section="all">All Users</div>
      <div class="admin-nav-item" data-section="withdrawals">Withdrawals</div>
      <div class="admin-nav-item" data-section="screenshotsPending">Pending Screenshots</div>
      <div class="admin-nav-item" data-section="screenshotsApproved">All Screenshots</div>
      <div class="admin-nav-item" data-section="userDetails">User Details</div>
    </div>
    
    <div class="admin-content">
      <!-- Dashboard Section -->
      <div class="admin-section active" id="dashboardSection">
        <h2>Admin Dashboard</h2>
        <div class="stats-container">
          <div class="stat-card">
            <div class="stat-value" id="totalUsers">0</div>
            <div class="stat-label">Total Users</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="pendingUsers">0</div>
            <div class="stat-label">Pending Users</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="approvedUsers">0</div>
            <div class="stat-label">Approved Users</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="pendingWithdrawals">0</div>
            <div class="stat-label">Pending Withdrawals</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="pendingScreenshots">0</div>
            <div class="stat-label">Pending Screenshots</div>
          </div>
        </div>
      </div>
      
      <!-- Pending Requests Section -->
      <div class="admin-section" id="pendingSection">
        <h2>Pending Requests</h2>
        <div id="pendingList" class="user-list">
          <!-- Pending users will be populated here -->
        </div>
      </div>
      
      <!-- Approved Users Section -->
      <div class="admin-section" id="approvedSection">
        <h2>Approved Users</h2>
        <div id="approvedList" class="user-list">
          <!-- Approved users will be populated here -->
        </div>
      </div>
      
      <!-- Rejected Users Section -->
      <div class="admin-section" id="rejectedSection">
        <h2>Rejected Users</h2>
        <div id="rejectedList" class="user-list">
          <!-- Rejected users will be populated here -->
        </div>
      </div>
      
      <!-- All Users Section -->
      <div class="admin-section" id="allSection">
        <h2>All Users</h2>
        <div id="allList" class="user-list">
          <!-- All users will be populated here -->
        </div>
      </div>
      
      <!-- Withdrawals Section -->
      <div class="admin-section" id="withdrawalsSection">
        <h2>Withdrawal Requests</h2>
        <div id="withdrawalsList" class="user-list">
          <!-- Withdrawal requests will be populated here -->
        </div>
      </div>
      
      <!-- Pending Screenshots Section -->
      <div class="admin-section" id="screenshotsPendingSection">
        <h2>Pending Screenshots</h2>
        <div id="pendingScreenshotsList" class="user-list">
          <!-- Pending screenshots will be populated here -->
        </div>
      </div>
      
      <!-- Approved Screenshots Section -->
      <div class="admin-section" id="screenshotsApprovedSection">
        <h2>All Screenshots</h2>
        <div id="approvedScreenshotsList" class="user-list">
          <!-- Approved screenshots will be populated here -->
        </div>
      </div>
      
      <!-- User Details Section -->
      <div class="admin-section" id="userDetailsSection">
        <h2>User Details</h2>
        <div id="userDetailsList" class="user-list">
          <!-- User details will be populated here -->
        </div>
      </div>
    </div>
  </div>

  <!-- User Details Modal -->
  <div class="modal" id="userDetailsModal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title" id="modalUserTitle">User Details</div>
        <button class="close-modal" id="closeModal">&times;</button>
      </div>
      <div id="modalUserContent">
        <!-- User details will be populated here -->
      </div>
      <div class="modal-actions">
        <button class="modal-action-btn delete-btn" id="deleteAccountBtn">Delete Account</button>
        <button class="modal-action-btn add-points-btn" id="addPointsBtn">Add Points</button>
        <button class="modal-action-btn remove-points-btn" id="removePointsBtn">Remove Points</button>
        <button class="modal-action-btn add-bdt-btn" id="addBdtBtn">Add BDT</button>
        <input type="number" id="pointsInput" class="points-input" placeholder="Enter points" style="display: none;">
        <input type="number" id="bdtInput" class="points-input" placeholder="Enter BDT amount" style="display: none;">
      </div>
    </div>
  </div>

  <!-- Screenshot Modal -->
  <div class="modal" id="screenshotModal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title" id="modalScreenshotTitle">Screenshot Details</div>
        <button class="close-modal" id="closeScreenshotModal">&times;</button>
      </div>
      <div id="modalScreenshotContent">
        <!-- Screenshot details will be populated here -->
      </div>
      <div class="modal-actions" id="screenshotModalActions">
        <button class="modal-action-btn approve-btn" id="approveScreenshotBtn">Approve</button>
        <button class="modal-action-btn reject-btn" id="rejectScreenshotBtn">Reject</button>
        <button class="modal-action-btn delete-btn" id="deleteScreenshotBtn">Delete</button>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
  
  <script>
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyAVwVzvV0eAcJ3d3X5iQGXkldWSIj4CJe0",
      authDomain: "earnwab.firebaseapp.com",
      databaseURL: "https://earnwab-default-rtdb.firebaseio.com",
      projectId: "earnwab",
      storageBucket: "earnwab.appspot.com",
      messagingSenderId: "341915592864",
      appId: "1:341915592864:web:f68363b7116b2a1cd741c5",
      measurementId: "G-QNJYEQPZ1B"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const database = firebase.database();

    // DOM Elements
    const loginContainer = document.getElementById('loginContainer');
    const registerContainer = document.getElementById('registerContainer');
    const pendingContainer = document.getElementById('pendingContainer');
    const dashboardContainer = document.getElementById('dashboardContainer');
    const workMenuContainer = document.getElementById('workMenuContainer');
    const helpContainer = document.getElementById('helpContainer');
    const profileContainer = document.getElementById('profileContainer');
    const referralContainer = document.getElementById('referralContainer');
    const balanceContainer = document.getElementById('balanceContainer');
    const withdrawContainer = document.getElementById('withdrawContainer');
    const historyContainer = document.getElementById('historyContainer');
    const noticeContainer = document.getElementById('noticeContainer');
    const offerContainer = document.getElementById('offerContainer');
    const leaderboardContainer = document.getElementById('leaderboardContainer');
    const screenshotContainer = document.getElementById('screenshotContainer');
    const adminDashboard = document.getElementById('adminDashboard');
    const userDetailsModal = document.getElementById('userDetailsModal');
    const screenshotModal = document.getElementById('screenshotModal');
    const addScreenshotBtn = document.getElementById('addScreenshotBtn');
    
    const showRegister = document.getElementById('showRegister');
    const showLogin = document.getElementById('showLogin');
    
    const loginBtn = document.getElementById('loginBtn');
    const registerBtn = document.getElementById('registerBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const adminLogoutBtn = document.getElementById('adminLogoutBtn');
    const backToDashboardBtn = document.getElementById('backToDashboardBtn');
    const backToDashboardFromHelpBtn = document.getElementById('backToDashboardFromHelpBtn');
    const backToDashboardFromProfileBtn = document.getElementById('backToDashboardFromProfileBtn');
    const backToDashboardFromReferralBtn = document.getElementById('backToDashboardFromReferralBtn');
    const backToDashboardFromBalanceBtn = document.getElementById('backToDashboardFromBalanceBtn');
    const backToDashboardFromWithdrawBtn = document.getElementById('backToDashboardFromWithdrawBtn');
    const backToDashboardFromHistoryBtn = document.getElementById('backToDashboardFromHistoryBtn');
    const backToDashboardFromNoticeBtn = document.getElementById('backToDashboardFromNoticeBtn');
    const backToDashboardFromOfferBtn = document.getElementById('backToDashboardFromOfferBtn');
    const backToDashboardFromLeaderboardBtn = document.getElementById('backToDashboardFromLeaderboardBtn');
    const backToDashboardFromScreenshotBtn = document.getElementById('backToDashboardFromScreenshotBtn');
    const workCard = document.getElementById('workCard');
    const helpCard = document.getElementById('helpCard');
    const profileCard = document.getElementById('profileCard');
    const referCard = document.getElementById('referCard');
    const balanceCard = document.getElementById('balanceCard');
    const withdrawCard = document.getElementById('withdrawCard');
    const historyCard = document.getElementById('historyCard');
    const noticeCard = document.getElementById('noticeCard');
    const noticeCard2 = document.getElementById('noticeCard2');
    const offerCard = document.getElementById('offerCard');
    const leaderboardCard = document.getElementById('leaderboardCard');
    const screenshotCard = document.getElementById('screenshotCard');
    
    const loginEmail = document.getElementById('loginEmail');
    const loginPassword = document.getElementById('loginPassword');
    
    const username = document.getElementById('username');
    const name = document.getElementById('name');
    const gender = document.getElementById('gender');
    const education = document.getElementById('education');
    const email = document.getElementById('email');
    const password = document.getElementById('password');
    const whatsapp = document.getElementById('whatsapp');
    const referral = document.getElementById('referral');
    const paymentMethod = document.getElementById('paymentMethod');
    const paymentNumber = document.getElementById('paymentNumber');
    const transactionId = document.getElementById('transactionId');
    const datetime = document.getElementById('datetime');
    const agreeTerms = document.getElementById('agreeTerms');
    
    const loginError = document.getElementById('loginError');
    const registerError = document.getElementById('registerError');
    const registerSuccess = document.getElementById('registerSuccess');
    
    const dashboardUsername = document.getElementById('dashboardUsername');
    
    // Referral elements
    const referralCodeDisplay = document.getElementById('referralCodeDisplay');
    const copyReferralBtn = document.getElementById('copyReferralBtn');
    const referralLink = document.getElementById('referralLink');
    const totalReferrals = document.getElementById('totalReferrals');
    const referralPoints = document.getElementById('referralPoints');
    const referralHistoryList = document.getElementById('referralHistoryList');
    
    // Balance elements
    const balanceAmount = document.getElementById('balanceAmount');
    const pointsDisplayBalance = document.getElementById('pointsDisplayBalance');
    const convertBtn = document.getElementById('convertBtn');
    
    // Withdraw elements
    const withdrawBalanceAmount = document.getElementById('withdrawBalanceAmount');
    const withdrawMessage = document.getElementById('withdrawMessage');
    const withdrawForm = document.getElementById('withdrawForm');
    const withdrawMethod = document.getElementById('withdrawMethod');
    const withdrawNumber = document.getElementById('withdrawNumber');
    const withdrawBtn = document.getElementById('withdrawBtn');
    
    // History elements
    const historyList = document.getElementById('historyList');
    
    // Profile level elements
    const levelDisplay = document.getElementById('levelDisplay');
    const pointsDisplay = document.getElementById('pointsDisplay');
    const progressBar = document.getElementById('progressBar');
    const level1Reward = document.getElementById('level1Reward');
    const level2Reward = document.getElementById('level2Reward');
    const level3Reward = document.getElementById('level3Reward');
    const level4Reward = document.getElementById('level4Reward');
    const level5Reward = document.getElementById('level5Reward');
    
    // Leaderboard elements
    const leaderboardList = document.getElementById('leaderboardList');
    
    // Screenshot elements
    const screenshotForm = document.getElementById('screenshotForm');
    const screenshotLink = document.getElementById('screenshotLink');
    const screenshotDescription = document.getElementById('screenshotDescription');
    const submitScreenshotBtn = document.getElementById('submitScreenshotBtn');
    const screenshotList = document.getElementById('screenshotList');
    
    // Admin elements
    const adminNavItems = document.querySelectorAll('.admin-nav-item');
    const adminSections = document.querySelectorAll('.admin-section');
    const pendingList = document.getElementById('pendingList');
    const approvedList = document.getElementById('approvedList');
    const rejectedList = document.getElementById('rejectedList');
    const allList = document.getElementById('allList');
    const withdrawalsList = document.getElementById('withdrawalsList');
    const pendingScreenshotsList = document.getElementById('pendingScreenshotsList');
    const approvedScreenshotsList = document.getElementById('approvedScreenshotsList');
    const userDetailsList = document.getElementById('userDetailsList');
    const totalUsersEl = document.getElementById('totalUsers');
    const pendingUsersEl = document.getElementById('pendingUsers');
    const approvedUsersEl = document.getElementById('approvedUsers');
    const pendingWithdrawalsEl = document.getElementById('pendingWithdrawals');
    const pendingScreenshotsEl = document.getElementById('pendingScreenshots');
    
    // Modal elements
    const modalUserTitle = document.getElementById('modalUserTitle');
    const modalUserContent = document.getElementById('modalUserContent');
    const closeModal = document.getElementById('closeModal');
    const deleteAccountBtn = document.getElementById('deleteAccountBtn');
    const addPointsBtn = document.getElementById('addPointsBtn');
    const removePointsBtn = document.getElementById('removePointsBtn');
    const addBdtBtn = document.getElementById('addBdtBtn');
    const pointsInput = document.getElementById('pointsInput');
    const bdtInput = document.getElementById('bdtInput');
    
    // Screenshot modal elements
    const modalScreenshotTitle = document.getElementById('modalScreenshotTitle');
    const modalScreenshotContent = document.getElementById('modalScreenshotContent');
    const closeScreenshotModal = document.getElementById('closeScreenshotModal');
    const approveScreenshotBtn = document.getElementById('approveScreenshotBtn');
    const rejectScreenshotBtn = document.getElementById('rejectScreenshotBtn');
    const deleteScreenshotBtn = document.getElementById('deleteScreenshotBtn');

    // Admin emails
    const adminEmails = ['admin@earnwalk.com', 'dev123@gmail.com'];

    // Level thresholds
    const levelThresholds = [200, 500, 1000, 2000, 4000]; // Updated points needed for each level

    // Referral points
    const REFERRAL_SIGNUP_POINTS = 2;
    const REFERRAL_BONUS_POINTS = 5;
    const REFERRAL_BONUS_THRESHOLD = 10;

    // Points to BDT conversion
    const POINTS_TO_BDT_RATE = 150 / 500; // 500 points = 150 BDT
    const MIN_WITHDRAW_AMOUNT = 150;
    const MIN_POINTS_FOR_CONVERSION = 500;

    // Screenshot points
    const SCREENSHOT_POINTS = 10;

    // Current user data
    let currentUser = null;
    let currentUserData = null;
    let selectedUserForModal = null;
    let selectedScreenshotForModal = null;

    // Show/Hide Containers
    function showContainer(container) {
      loginContainer.style.display = 'none';
      registerContainer.style.display = 'none';
      pendingContainer.style.display = 'none';
      dashboardContainer.style.display = 'none';
      workMenuContainer.style.display = 'none';
      helpContainer.style.display = 'none';
      profileContainer.style.display = 'none';
      referralContainer.style.display = 'none';
      balanceContainer.style.display = 'none';
      withdrawContainer.style.display = 'none';
      historyContainer.style.display = 'none';
      noticeContainer.style.display = 'none';
      offerContainer.style.display = 'none';
      leaderboardContainer.style.display = 'none';
      screenshotContainer.style.display = 'none';
      adminDashboard.style.display = 'none';
      
      if (container) {
        container.style.display = 'block';
      }
      
      // Show/hide add screenshot button
      if (container === screenshotContainer) {
        addScreenshotBtn.style.display = 'block';
      } else {
        addScreenshotBtn.style.display = 'none';
      }
    }

    // Show modal
    function showModal() {
      userDetailsModal.style.display = 'flex';
    }

    // Hide modal
    function hideModal() {
      userDetailsModal.style.display = 'none';
      pointsInput.style.display = 'none';
      bdtInput.style.display = 'none';
    }

    // Show screenshot modal
    function showScreenshotModal() {
      screenshotModal.style.display = 'flex';
    }

    // Hide screenshot modal
    function hideScreenshotModal() {
      screenshotModal.style.display = 'none';
    }

    // Event Listeners
    showRegister.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(registerContainer);
    });
    
    showLogin.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(loginContainer);
    });
    
    logoutBtn.addEventListener('click', logout);
    adminLogoutBtn.addEventListener('click', logout);
    backToDashboardBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromHelpBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromProfileBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromReferralBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromBalanceBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromWithdrawBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromHistoryBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromNoticeBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromOfferBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromLeaderboardBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromScreenshotBtn.addEventListener('click', () => showContainer(dashboardContainer));
    
    workCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(workMenuContainer);
    });

    helpCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(helpContainer);
    });

    profileCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(profileContainer);
      updateProfileLevelDisplay();
    });

    referCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(referralContainer);
      loadReferralInfo();
    });

    balanceCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(balanceContainer);
      loadBalanceInfo();
    });

    withdrawCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(withdrawContainer);
      loadWithdrawInfo();
    });

    historyCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(historyContainer);
      loadUserHistory();
    });

    noticeCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(noticeContainer);
    });

    noticeCard2.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(noticeContainer);
    });

    offerCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(offerContainer);
    });

    leaderboardCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(leaderboardContainer);
      loadLeaderboard();
    });

    screenshotCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(screenshotContainer);
      loadUserScreenshots();
    });

    // Add screenshot button
    addScreenshotBtn.addEventListener('click', () => {
      screenshotForm.style.display = 'block';
      screenshotLink.value = '';
      screenshotDescription.value = '';
      screenshotLink.focus();
      window.scrollTo(0, 0);
    });

    // Submit screenshot
    submitScreenshotBtn.addEventListener('click', submitScreenshot);

    // Copy referral code
    copyReferralBtn.addEventListener('click', () => {
      navigator.clipboard.writeText(referralCodeDisplay.textContent)
        .then(() => {
          const originalText = copyReferralBtn.textContent;
          copyReferralBtn.textContent = 'Copied!';
          setTimeout(() => {
            copyReferralBtn.textContent = originalText;
          }, 2000);
        })
        .catch(err => {
          console.error('Failed to copy text: ', err);
        });
    });

    // Convert points to BDT
    convertBtn.addEventListener('click', convertPointsToBdt);

    // Withdraw money
    withdrawBtn.addEventListener('click', requestWithdraw);

    // Admin navigation
    adminNavItems.forEach(item => {
      item.addEventListener('click', () => {
        // Remove active class from all items
        adminNavItems.forEach(navItem => navItem.classList.remove('active'));
        // Add active class to clicked item
        item.classList.add('active');
        
        // Hide all sections
        adminSections.forEach(section => section.classList.remove('active'));
        // Show the selected section
        const sectionId = item.dataset.section + 'Section';
        document.getElementById(sectionId).classList.add('active');
        
        // Load data for the section if needed
        if (item.dataset.section === 'pending') {
          loadPendingUsers();
        } else if (item.dataset.section === 'approved') {
          loadApprovedUsers();
        } else if (item.dataset.section === 'rejected') {
          loadRejectedUsers();
        } else if (item.dataset.section === 'all') {
          loadAllUsers();
        } else if (item.dataset.section === 'withdrawals') {
          loadWithdrawalRequests();
        } else if (item.dataset.section === 'screenshotsPending') {
          loadPendingScreenshots();
        } else if (item.dataset.section === 'screenshotsApproved') {
          loadApprovedScreenshots();
        } else if (item.dataset.section === 'userDetails') {
          loadUserDetailsList();
        }
      });
    });

    // Modal events
    closeModal.addEventListener('click', hideModal);
    
    addPointsBtn.addEventListener('click', () => {
      if (pointsInput.style.display === 'none') {
        pointsInput.style.display = 'block';
        bdtInput.style.display = 'none';
        pointsInput.focus();
      } else {
        const points = parseInt(pointsInput.value);
        if (points > 0) {
          addUserPoints(selectedUserForModal.uid, points);
          pointsInput.value = '';
          pointsInput.style.display = 'none';
        }
      }
    });
    
    removePointsBtn.addEventListener('click', () => {
      if (pointsInput.style.display === 'none') {
        pointsInput.style.display = 'block';
        bdtInput.style.display = 'none';
        pointsInput.focus();
      } else {
        const points = parseInt(pointsInput.value);
        if (points > 0) {
          removeUserPoints(selectedUserForModal.uid, points);
          pointsInput.value = '';
          pointsInput.style.display = 'none';
        }
      }
    });
    
    addBdtBtn.addEventListener('click', () => {
      if (bdtInput.style.display === 'none') {
        bdtInput.style.display = 'block';
        pointsInput.style.display = 'none';
        bdtInput.focus();
      } else {
        const amount = parseInt(bdtInput.value);
        if (amount > 0) {
          addUserBdt(selectedUserForModal.uid, amount);
          bdtInput.value = '';
          bdtInput.style.display = 'none';
        }
      }
    });
    
    deleteAccountBtn.addEventListener('click', () => {
      if (confirm('Are you sure you want to delete this account? This cannot be undone.')) {
        deleteUserAccount(selectedUserForModal.uid);
      }
    });

    // Screenshot modal events
    closeScreenshotModal.addEventListener('click', hideScreenshotModal);
    
    approveScreenshotBtn.addEventListener('click', () => {
      approveScreenshot(selectedScreenshotForModal.key);
    });
    
    rejectScreenshotBtn.addEventListener('click', () => {
      rejectScreenshot(selectedScreenshotForModal.key);
    });
    
    deleteScreenshotBtn.addEventListener('click', () => {
      if (confirm('Are you sure you want to delete this screenshot?')) {
        deleteScreenshot(selectedScreenshotForModal.key);
      }
    });

    // Submit Screenshot
    function submitScreenshot() {
      if (!currentUser || !currentUserData) return;
      
      const link = screenshotLink.value.trim();
      const description = screenshotDescription.value.trim();
      
      if (!link) {
        alert('Please enter an image URL');
        return;
      }
      
      // Validate URL
      try {
        new URL(link);
      } catch (e) {
        alert('Please enter a valid URL');
        return;
      }
      
      const screenshotData = {
        userId: currentUser.uid,
        username: currentUserData.username,
        name: currentUserData.name,
        imageUrl: link,
        description: description || '',
        status: 'pending',
        timestamp: firebase.database.ServerValue.TIMESTAMP
      };
      
      database.ref('screenshots').push(screenshotData)
        .then(() => {
          alert('Screenshot submitted successfully! It will be reviewed by admin.');
          screenshotForm.style.display = 'none';
          loadUserScreenshots();
        })
        .catch(error => {
          console.error('Error submitting screenshot:', error);
          alert('Failed to submit screenshot. Please try again.');
        });
    }

    // Load user screenshots
    function loadUserScreenshots() {
      if (!currentUser || !currentUserData) return;
      
      database.ref('screenshots').orderByChild('userId').equalTo(currentUser.uid).once('value')
        .then(snapshot => {
          screenshotList.innerHTML = '';
          
          if (!snapshot.exists()) {
            screenshotList.innerHTML = '<div class="screenshot-item">No screenshots submitted yet</div>';
            return;
          }
          
          const screenshots = [];
          snapshot.forEach(child => {
            screenshots.push({
              key: child.key,
              ...child.val()
            });
          });
          
          // Sort by timestamp (newest first)
          screenshots.sort((a, b) => b.timestamp - a.timestamp);
          
          screenshots.forEach(screenshot => {
            const screenshotItem = document.createElement('div');
            screenshotItem.className = 'screenshot-item';
            
            let statusClass = '';
            let statusText = '';
            
            if (screenshot.status === 'pending') {
              statusClass = 'status-pending';
              statusText = 'Pending';
            } else if (screenshot.status === 'approved') {
              statusClass = 'status-approved';
              statusText = 'Approved';
            } else if (screenshot.status === 'rejected') {
              statusClass = 'status-rejected';
              statusText = 'Rejected';
            }
            
            const date = new Date(screenshot.timestamp);
            const dateStr = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
            
            screenshotItem.innerHTML = `
              <div class="screenshot-status ${statusClass}">${statusText}</div>
              <img src="${screenshot.imageUrl}" alt="Screenshot" class="screenshot-image" onerror="this.src='https://via.placeholder.com/500x300?text=Image+Not+Available'">
              ${screenshot.description ? `<p>${screenshot.description}</p>` : ''}
              <div class="screenshot-date">${dateStr}</div>
            `;
            
            screenshotList.appendChild(screenshotItem);
          });
        })
        .catch(error => {
          console.error('Error loading screenshots:', error);
          screenshotList.innerHTML = '<div class="screenshot-item">Error loading screenshots</div>';
        });
    }

    // Load pending screenshots for admin
    function loadPendingScreenshots() {
      database.ref('screenshots').orderByChild('status').equalTo('pending').once('value')
        .then(snapshot => {
          pendingScreenshotsList.innerHTML = '';
          
          if (!snapshot.exists()) {
            pendingScreenshotsList.innerHTML = '<div class="screenshot-admin-item">No pending screenshots</div>';
            return;
          }
          
          const screenshots = [];
          snapshot.forEach(child => {
            screenshots.push({
              key: child.key,
              ...child.val()
            });
          });
          
          // Sort by timestamp (oldest first)
          screenshots.sort((a, b) => a.timestamp - b.timestamp);
          
          screenshots.forEach(screenshot => {
            const screenshotItem = document.createElement('div');
            screenshotItem.className = 'screenshot-admin-item';
            
            const date = new Date(screenshot.timestamp);
            const dateStr = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
            
            screenshotItem.innerHTML = `
              <div class="screenshot-admin-info">
                <span class="screenshot-admin-user">${screenshot.name} (${screenshot.username})</span>
                <span> - ${dateStr}</span>
              </div>
              <img src="${screenshot.imageUrl}" alt="Screenshot" class="screenshot-admin-image" onerror="this.src='https://via.placeholder.com/500x300?text=Image+Not+Available'">
              ${screenshot.description ? `<p>${screenshot.description}</p>` : ''}
              <div class="action-buttons">
                <button class="action-btn approve-btn" data-key="${screenshot.key}">Approve</button>
                <button class="action-btn reject-btn" data-key="${screenshot.key}">Reject</button>
                <button class="action-btn view-btn" data-key="${screenshot.key}">View</button>
              </div>
            `;
            
            // Add event listeners
            screenshotItem.querySelector('.approve-btn').addEventListener('click', () => {
              approveScreenshot(screenshot.key);
            });
            
            screenshotItem.querySelector('.reject-btn').addEventListener('click', () => {
              rejectScreenshot(screenshot.key);
            });
            
            screenshotItem.querySelector('.view-btn').addEventListener('click', () => {
              viewScreenshot(screenshot);
            });
            
            pendingScreenshotsList.appendChild(screenshotItem);
          });
        })
        .catch(error => {
          console.error('Error loading pending screenshots:', error);
          pendingScreenshotsList.innerHTML = '<div class="screenshot-admin-item">Error loading screenshots</div>';
        });
    }

    // Load approved screenshots for admin
    function loadApprovedScreenshots() {
      database.ref('screenshots').orderByChild('status').equalTo('approved').once('value')
        .then(snapshot => {
          approvedScreenshotsList.innerHTML = '';
          
          if (!snapshot.exists()) {
            approvedScreenshotsList.innerHTML = '<div class="screenshot-admin-item">No approved screenshots</div>';
            return;
          }
          
          const screenshots = [];
          snapshot.forEach(child => {
            screenshots.push({
              key: child.key,
              ...child.val()
            });
          });
          
          // Sort by timestamp (newest first)
          screenshots.sort((a, b) => b.timestamp - a.timestamp);
          
          screenshots.forEach(screenshot => {
            const screenshotItem = document.createElement('div');
            screenshotItem.className = 'screenshot-admin-item';
            
            const date = new Date(screenshot.timestamp);
            const dateStr = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
            
            screenshotItem.innerHTML = `
              <div class="screenshot-admin-info">
                <span class="screenshot-admin-user">${screenshot.name} (${screenshot.username})</span>
                <span> - ${dateStr}</span>
              </div>
              <img src="${screenshot.imageUrl}" alt="Screenshot" class="screenshot-admin-image" onerror="this.src='https://via.placeholder.com/500x300?text=Image+Not+Available'">
              ${screenshot.description ? `<p>${screenshot.description}</p>` : ''}
              <div class="action-buttons">
                <button class="action-btn delete-btn" data-key="${screenshot.key}">Delete</button>
                <button class="action-btn view-btn" data-key="${screenshot.key}">View</button>
              </div>
            `;
            
            // Add event listeners
            screenshotItem.querySelector('.delete-btn').addEventListener('click', () => {
              if (confirm('Are you sure you want to delete this screenshot?')) {
                deleteScreenshot(screenshot.key);
              }
            });
            
            screenshotItem.querySelector('.view-btn').addEventListener('click', () => {
              viewScreenshot(screenshot);
            });
            
            approvedScreenshotsList.appendChild(screenshotItem);
          });
        })
        .catch(error => {
          console.error('Error loading approved screenshots:', error);
          approvedScreenshotsList.innerHTML = '<div class="screenshot-admin-item">Error loading screenshots</div>';
        });
    }

    // Approve screenshot
    function approveScreenshot(screenshotKey) {
      database.ref('screenshots/' + screenshotKey).once('value')
        .then(snapshot => {
          const screenshot = snapshot.val();
          
          // Update screenshot status
          database.ref('screenshots/' + screenshotKey).update({ status: 'approved' })
            .then(() => {
              // Add points to user
              addPointsForUser(screenshot.userId, SCREENSHOT_POINTS, 'Screenshot approved');
              
              // Record history
              recordHistoryForUser(screenshot.userId, {
                type: 'screenshot',
                points: SCREENSHOT_POINTS,
                details: 'Screenshot approved',
                timestamp: firebase.database.ServerValue.TIMESTAMP
              });
              
              // Refresh lists
              loadPendingScreenshots();
              loadApprovedScreenshots();
              loadAdminStats();
              
              hideScreenshotModal();
            });
        })
        .catch(error => {
          console.error('Error approving screenshot:', error);
          alert('Failed to approve screenshot');
        });
    }

    // Reject screenshot
    function rejectScreenshot(screenshotKey) {
      database.ref('screenshots/' + screenshotKey).update({ status: 'rejected' })
        .then(() => {
          // Refresh lists
          loadPendingScreenshots();
          loadApprovedScreenshots();
          loadAdminStats();
          
          hideScreenshotModal();
        })
        .catch(error => {
          console.error('Error rejecting screenshot:', error);
          alert('Failed to reject screenshot');
        });
    }

    // Delete screenshot
    function deleteScreenshot(screenshotKey) {
      database.ref('screenshots/' + screenshotKey).remove()
        .then(() => {
          // Refresh lists
          loadPendingScreenshots();
          loadApprovedScreenshots();
          loadAdminStats();
          
          hideScreenshotModal();
        })
        .catch(error => {
          console.error('Error deleting screenshot:', error);
          alert('Failed to delete screenshot');
        });
    }

    // View screenshot in modal
    function viewScreenshot(screenshot) {
      selectedScreenshotForModal = screenshot;
      
      modalScreenshotTitle.textContent = `Screenshot by ${screenshot.name}`;
      
      modalScreenshotContent.innerHTML = `
        <div class="screenshot-admin-info">
          <span class="screenshot-admin-user">${screenshot.name} (${screenshot.username})</span>
        </div>
        <img src="${screenshot.imageUrl}" alt="Screenshot" class="screenshot-admin-image" style="max-height: 300px; object-fit: contain;" onerror="this.src='https://via.placeholder.com/500x300?text=Image+Not+Available'">
        ${screenshot.description ? `<p>${screenshot.description}</p>` : ''}
        <div class="screenshot-date">Submitted: ${new Date(screenshot.timestamp).toLocaleString()}</div>
        <div class="screenshot-status ${screenshot.status === 'pending' ? 'status-pending' : screenshot.status === 'approved' ? 'status-approved' : 'status-rejected'}">
          Status: ${screenshot.status}
        </div>
      `;
      
      // Show appropriate buttons based on status
      if (screenshot.status === 'pending') {
        approveScreenshotBtn.style.display = 'block';
        rejectScreenshotBtn.style.display = 'block';
        deleteScreenshotBtn.style.display = 'none';
      } else {
        approveScreenshotBtn.style.display = 'none';
        rejectScreenshotBtn.style.display = 'none';
        deleteScreenshotBtn.style.display = 'block';
      }
      
      showScreenshotModal();
    }

    // Load user details list for admin
    function loadUserDetailsList() {
      database.ref('users').once('value')
        .then(snapshot => {
          userDetailsList.innerHTML = '';
          
          if (!snapshot.exists()) {
            userDetailsList.innerHTML = '<div class="user-card">No users found</div>';
            return;
          }
          
          const users = [];
          snapshot.forEach(child => {
            users.push(child.val());
          });
          
          // Sort by username
          users.sort((a, b) => a.username.localeCompare(b.username));
          
          users.forEach(user => {
            const userCard = document.createElement('div');
            userCard.className = 'user-card';
            
            userCard.innerHTML = `
              <div class="user-info">
                <div class="user-name">${user.username}</div>
                <div class="user-email">${user.email}</div>
                <div class="user-status ${user.status === 'pending' ? 'pending' : user.status === 'approved' ? 'approved' : 'rejected'}">${user.status}</div>
                <div>Points: ${user.points || 0}</div>
                <div>Balance: ${user.balance || 0} BDT</div>
              </div>
              <div class="action-buttons">
                <button class="action-btn view-btn" data-uid="${user.uid}">View</button>
              </div>
            `;
            
            // Add event listener
            userCard.querySelector('.view-btn').addEventListener('click', () => {
              viewUser(user);
            });
            
            userDetailsList.appendChild(userCard);
          });
        })
        .catch(error => {
          console.error('Error loading user details:', error);
          userDetailsList.innerHTML = '<div class="user-card">Error loading users</div>';
        });
    }

    // Update Profile Level Display
    function updateProfileLevelDisplay() {
      if (!currentUserData) return;
      
      const points = currentUserData.points || 0;
      let currentLevel = 1;
      let nextLevelThreshold = levelThresholds[0];
      
      // Determine current level
      for (let i = levelThresholds.length - 1; i >= 0; i--) {
        if (points >= levelThresholds[i]) {
          currentLevel = i + 1;
          nextLevelThreshold = i < levelThresholds.length - 1 ? levelThresholds[i + 1] : levelThresholds[i];
          break;
        }
      }
      
      // Update level display
      levelDisplay.textContent = `Level ${currentLevel}`;
      pointsDisplay.textContent = `${points} Points`;
      
      // Update progress bar
      const progressPercentage = currentLevel < levelThresholds.length 
        ? ((points - (currentLevel > 1 ? levelThresholds[currentLevel - 2] : 0)) / (nextLevelThreshold - (currentLevel > 1 ? levelThresholds[currentLevel - 2] : 0))) * 100
        : 100;
      progressBar.style.width = `${progressPercentage}%`;
      
      // Update reward achievements
      level1Reward.textContent = points >= levelThresholds[0] ? '?' : '?';
      level2Reward.textContent = points >= levelThresholds[1] ? '?' : '?';
      level3Reward.textContent = points >= levelThresholds[2] ? '?' : '?';
      level4Reward.textContent = points >= levelThresholds[3] ? '?' : '?';
      level5Reward.textContent = points >= levelThresholds[4] ? '?' : '?';
    }

    // Load Balance Info
    function loadBalanceInfo() {
      if (!currentUser || !currentUserData) return;
      
      const points = currentUserData.points || 0;
      const balance = currentUserData.balance || 0;
      
      pointsDisplayBalance.textContent = `${points} Points`;
      balanceAmount.textContent = `${balance} BDT`;
      
      // Enable/disable convert button based on points
      convertBtn.disabled = points < MIN_POINTS_FOR_CONVERSION;
    }

    // Load Withdraw Info
    function loadWithdrawInfo() {
      if (!currentUser || !currentUserData) return;
      
      const balance = currentUserData.balance || 0;
      
      withdrawBalanceAmount.textContent = `${balance} BDT`;
      
      // Check if user has pending withdrawal
      database.ref('withdrawals').orderByChild('userId').equalTo(currentUser.uid).once('value')
        .then(snapshot => {
          if (snapshot.exists()) {
            let hasPending = false;
            snapshot.forEach(child => {
              const withdrawal = child.val();
              if (withdrawal.status === 'pending') {
                hasPending = true;
              }
            });
            
            if (hasPending) {
              withdrawForm.style.display = 'none';
              withdrawMessage.style.display = 'block';
            } else {
              withdrawForm.style.display = 'block';
              withdrawMessage.style.display = 'none';
            }
          } else {
            withdrawForm.style.display = 'block';
            withdrawMessage.style.display = 'none';
          }
        });
      
      // Enable/disable withdraw button based on balance
      withdrawBtn.disabled = (balance < MIN_WITHDRAW_AMOUNT);
    }

    // Convert Points to BDT
    function convertPointsToBdt() {
      if (!currentUser || !currentUserData) return;
      
      const points = currentUserData.points || 0;
      const currentBalance = currentUserData.balance || 0;
      
      if (points < MIN_POINTS_FOR_CONVERSION) {
        alert(`You need at least ${MIN_POINTS_FOR_CONVERSION} points to convert to BDT`);
        return;
      }
      
      // Calculate BDT amount (500 points = 150 BDT)
      const bdtAmount = 150;
      const newPoints = points - MIN_POINTS_FOR_CONVERSION;
      const newBalance = currentBalance + bdtAmount;
      
      // Update user data
      database.ref('users/' + currentUser.uid).update({
        points: newPoints,
        balance: newBalance
      })
      .then(() => {
        currentUserData.points = newPoints;
        currentUserData.balance = newBalance;
        
        // Update display
        pointsDisplayBalance.textContent = `${newPoints} Points`;
        balanceAmount.textContent = `${newBalance} BDT`;
        convertBtn.disabled = newPoints < MIN_POINTS_FOR_CONVERSION;
        
        // Record history
        recordHistory({
          type: 'conversion',
          points: -MIN_POINTS_FOR_CONVERSION,
          details: `Converted ${MIN_POINTS_FOR_CONVERSION} points to ${bdtAmount} BDT`,
          timestamp: firebase.database.ServerValue.TIMESTAMP
        });
        
        recordHistory({
          type: 'balance',
          amount: bdtAmount,
          details: `Added ${bdtAmount} BDT from points conversion`,
          timestamp: firebase.database.ServerValue.TIMESTAMP
        });
        
        alert(`Successfully converted ${MIN_POINTS_FOR_CONVERSION} points to ${bdtAmount} BDT`);
      })
      .catch(error => {
        console.error('Error converting points:', error);
        alert('Failed to convert points. Please try again.');
      });
    }

    // Request Withdraw
    function requestWithdraw() {
      if (!currentUser || !currentUserData) return;
      
      const balance = currentUserData.balance || 0;
      const method = withdrawMethod.value;
      const number = withdrawNumber.value;
      
      if (!method || !number) {
        alert('Please select a withdrawal method and enter your account number');
        return;
      }
      
      if (balance < MIN_WITHDRAW_AMOUNT) {
        alert(`You need at least ${MIN_WITHDRAW_AMOUNT} BDT to withdraw`);
        return;
      }
      
      // Create withdrawal request
      const withdrawalData = {
        userId: currentUser.uid,
        username: currentUserData.username,
        name: currentUserData.name,
        method: method,
        number: number,
        amount: MIN_WITHDRAW_AMOUNT,
        status: 'pending',
        timestamp: firebase.database.ServerValue.TIMESTAMP
      };
      
      database.ref('withdrawals').push(withdrawalData)
        .then(() => {
          // Show pending message
          withdrawForm.style.display = 'none';
          withdrawMessage.style.display = 'block';
          
          // Record history
          recordHistory({
            type: 'withdrawal',
            amount: -MIN_WITHDRAW_AMOUNT,
            details: `Withdrawal request of ${MIN_WITHDRAW_AMOUNT} BDT via ${method} (${number})`,
            timestamp: firebase.database.ServerValue.TIMESTAMP
          });
          
          alert('Withdrawal request submitted. Admin will process it within 24 hours.');
        })
        .catch(error => {
          console.error('Error submitting withdrawal:', error);
          alert('Failed to submit withdrawal request. Please try again.');
        });
    }

    // Load Leaderboard
    function loadLeaderboard() {
      database.ref('users').orderByChild('points').once('value')
        .then((snapshot) => {
          leaderboardList.innerHTML = '';
          
          if (!snapshot.exists()) {
            leaderboardList.innerHTML = '<div class="leaderboard-item">No users found</div>';
            return;
          }
          
          const users = [];
          snapshot.forEach(childSnapshot => {
            const user = childSnapshot.val();
            if (user.status === 'approved') {
              users.push(user);
            }
          });
          
          // Sort by points (descending)
          users.sort((a, b) => (b.points || 0) - (a.points || 0));
          
          // Show top 15 users
          const topUsers = users.slice(0, 15);
          
          if (topUsers.length === 0) {
            leaderboardList.innerHTML = '<div class="leaderboard-item">No users found</div>';
            return;
          }
          
          topUsers.forEach((user, index) => {
            const leaderboardItem = document.createElement('div');
            leaderboardItem.className = 'leaderboard-item';
            
            leaderboardItem.innerHTML = `
              <div class="leaderboard-rank">${index + 1}</div>
              <div class="leaderboard-user">
                <div class="leaderboard-name">${user.username}</div>
                <div class="leaderboard-points">${user.points || 0} points</div>
              </div>
            `;
            
            leaderboardList.appendChild(leaderboardItem);
          });
        })
        .catch((error) => {
          console.error('Error loading leaderboard:', error);
        });
    }

    // Add points to user
    function addPoints(pointsToAdd, type = 'other', details = '') {
      if (!currentUser || !currentUserData) return;
      
      const currentPoints = currentUserData.points || 0;
      const newPoints = currentPoints + pointsToAdd;
      
      // Update points in database
      database.ref('users/' + currentUser.uid).update({ points: newPoints })
        .then(() => {
          currentUserData.points = newPoints;
          updateProfileLevelDisplay();
          
          // Update balance display if on that page
          if (balanceContainer.style.display === 'block') {
            loadBalanceInfo();
          }
          
          // Record the transaction in history
          recordHistory({
            type: type,
            points: pointsToAdd,
            details: details,
            timestamp: firebase.database.ServerValue.TIMESTAMP
          });
        })
        .catch((error) => {
          console.error('Error updating points:', error);
        });
    }

    // Load referral information
    function loadReferralInfo() {
      if (!currentUser || !currentUserData) return;
      
      // Generate referral code from user ID (first 8 characters)
      const referralCode = currentUser.uid.substring(0, 8).toUpperCase();
      referralCodeDisplay.textContent = referralCode;
      
      // Generate referral link
      const referralUrl = `${window.location.origin}${window.location.pathname}?ref=${referralCode}`;
      referralLink.textContent = referralUrl;
      
      // Load referral stats
      database.ref('referrals').orderByChild('referrerId').equalTo(currentUser.uid).once('value')
        .then((snapshot) => {
          let total = 0;
          let pointsEarned = 0;
          
          snapshot.forEach(childSnapshot => {
            const referral = childSnapshot.val();
            total++;
            pointsEarned += referral.pointsEarned || 0;
          });
          
          totalReferrals.textContent = total;
          referralPoints.textContent = pointsEarned;
        });
      
      // Load referral history
      loadReferralHistory();
    }

    // Load referral history
    function loadReferralHistory() {
      if (!currentUser || !currentUserData) return;
      
      database.ref('referrals').orderByChild('referrerId').equalTo(currentUser.uid).once('value')
        .then((snapshot) => {
          referralHistoryList.innerHTML = '';
          
          if (!snapshot.exists()) {
            referralHistoryList.innerHTML = '<div class="history-item">No referral activity yet</div>';
            return;
          }
          
          const referrals = [];
          snapshot.forEach(childSnapshot => {
            referrals.push(childSnapshot.val());
          });
          
          // Sort by timestamp (newest first)
          referrals.sort((a, b) => b.timestamp - a.timestamp);
          
          // Display only the last 5 referrals
          const recentReferrals = referrals.slice(0, 5);
          
          recentReferrals.forEach(ref => {
            const historyItem = document.createElement('div');
            historyItem.className = 'history-item';
            
            const date = new Date(ref.timestamp);
            const dateStr = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
            
            historyItem.innerHTML = `
              <div>Referred: ${ref.referredName || ref.referredEmail}</div>
              <div>Points Earned: ${ref.pointsEarned}</div>
              <div class="date">${dateStr}</div>
            `;
            
            referralHistoryList.appendChild(historyItem);
          });
        })
        .catch((error) => {
          console.error('Error loading referral history:', error);
        });
    }

    // Load user history
    function loadUserHistory() {
      if (!currentUser || !currentUserData) return;
      
      database.ref('history').orderByChild('userId').equalTo(currentUser.uid).once('value')
        .then((snapshot) => {
          historyList.innerHTML = '';
          
          if (!snapshot.exists()) {
            historyList.innerHTML = '<div class="history-entry">No history yet</div>';
            return;
          }
          
          const historyItems = [];
          snapshot.forEach(childSnapshot => {
            historyItems.push(childSnapshot.val());
          });
          
          // Sort by timestamp (newest first)
          historyItems.sort((a, b) => b.timestamp - a.timestamp);
          
          historyItems.forEach(item => {
            const historyEntry = document.createElement('div');
            historyEntry.className = 'history-entry';
            
            const date = new Date(item.timestamp);
            const dateStr = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
            
            let details = '';
            if (item.type === 'balance' || item.type === 'withdrawal') {
              details = `${item.details || ''} ${item.amount ? `(${item.amount > 0 ? '+' : ''}${item.amount} BDT)` : ''}`;
            } else {
              details = `${item.details || ''} ${item.points ? `(${item.points > 0 ? '+' : ''}${item.points} points)` : ''}`;
            }
            
            historyEntry.innerHTML = `
              <div class="history-type">${getHistoryTypeLabel(item.type)}</div>
              <div class="history-details">${details}</div>
              <div class="history-date">${dateStr}</div>
            `;
            
            historyList.appendChild(historyEntry);
          });
        })
        .catch((error) => {
          console.error('Error loading user history:', error);
        });
    }

    // Get history type label
    function getHistoryTypeLabel(type) {
      const labels = {
        'referral': 'Referral Bonus',
        'referral_signup': 'Referral Signup',
        'work': 'Work Completed',
        'conversion': 'Points Conversion',
        'balance': 'Balance Update',
        'withdrawal': 'Withdrawal',
        'other': 'Points Added',
        'screenshot': 'Screenshot Approved'
      };
      return labels[type] || type;
    }

    // Record history
    function recordHistory(historyData) {
      if (!currentUser || !currentUserData) return;
      
      historyData.userId = currentUser.uid;
      
      database.ref('history').push(historyData)
        .catch(error => {
          console.error('Error recording history:', error);
        });
    }

    // Process referral if any
    function processReferral(referralCode) {
      if (!referralCode || !currentUser || !currentUserData) return;
      
      // Find user with this referral code (first 8 characters of UID)
      database.ref('users').orderByChild('status').equalTo('approved').once('value')
        .then((snapshot) => {
          let referrerId = null;
          let referrerData = null;
          
          snapshot.forEach(childSnapshot => {
            const user = childSnapshot.val();
            if (user.uid.substring(0, 8).toUpperCase() === referralCode.toUpperCase()) {
              referrerId = user.uid;
              referrerData = user;
            }
          });
          
          if (referrerId) {
            // Add referral record
            const referralData = {
              referrerId: referrerId,
              referrerName: referrerData.name,
              referredId: currentUser.uid,
              referredName: currentUserData.name,
              referredEmail: currentUserData.email,
              pointsEarned: REFERRAL_SIGNUP_POINTS,
              timestamp: firebase.database.ServerValue.TIMESTAMP
            };
            
            database.ref('referrals').push(referralData);
            
            // Add points to referrer
            database.ref('users/' + referrerId).once('value')
              .then((userSnapshot) => {
                const referrer = userSnapshot.val();
                const currentPoints = referrer.points || 0;
                const newPoints = currentPoints + REFERRAL_SIGNUP_POINTS;
                
                database.ref('users/' + referrerId).update({ points: newPoints });
                
                // Record history for referrer
                recordHistoryForUser(referrerId, {
                  type: 'referral_signup',
                  points: REFERRAL_SIGNUP_POINTS,
                  details: `New referral: ${currentUserData.name}`,
                  timestamp: firebase.database.ServerValue.TIMESTAMP
                });
              });
          }
        });
    }

    // Check if referred user reached threshold and award bonus
    function checkReferralBonus(userId) {
      database.ref('referrals').orderByChild('referredId').equalTo(userId).once('value')
        .then((snapshot) => {
          snapshot.forEach(childSnapshot => {
            const referral = childSnapshot.val();
            
            // Check if bonus already awarded
            if (!referral.bonusAwarded) {
              database.ref('users/' + userId).once('value')
                .then((userSnapshot) => {
                  const user = userSnapshot.val();
                  
                  if (user.points >= REFERRAL_BONUS_THRESHOLD) {
                    // Award bonus to referrer
                    const currentPoints = user.points || 0;
                    const newPoints = currentPoints + REFERRAL_BONUS_POINTS;
                    
                    database.ref('users/' + referral.referrerId).update({ points: newPoints });
                    
                    // Update referral record
                    database.ref('referrals/' + childSnapshot.key).update({
                      bonusAwarded: true,
                      pointsEarned: referral.pointsEarned + REFERRAL_BONUS_POINTS
                    });
                    
                    // Record history for referrer
                    recordHistoryForUser(referral.referrerId, {
                      type: 'referral',
                      points: REFERRAL_BONUS_POINTS,
                      details: `Referral bonus: ${user.name} reached ${REFERRAL_BONUS_THRESHOLD} points`,
                      timestamp: firebase.database.ServerValue.TIMESTAMP
                    });
                  }
                });
            }
          });
        });
    }

    // Record history for specific user
    function recordHistoryForUser(userId, historyData) {
      historyData.userId = userId;
      
      database.ref('history').push(historyData)
        .catch(error => {
          console.error('Error recording history:', error);
        });
    }

    // Check Auth State
    auth.onAuthStateChanged(user => {
      if (user) {
        // User is signed in
        currentUser = user;
        checkUserStatus(user.uid, user.email);
        
        // Check for referral code in URL
        const urlParams = new URLSearchParams(window.location.search);
        const referralCode = urlParams.get('ref');
        if (referralCode) {
          // Remove referral code from URL
          window.history.replaceState({}, document.title, window.location.pathname);
        }
      } else {
        // No user is signed in
        currentUser = null;
        currentUserData = null;
        showContainer(loginContainer);
      }
    });

    // Login Function
    loginBtn.addEventListener('click', () => {
      const email = loginEmail.value;
      const pass = loginPassword.value;
      
      if (!email || !pass) {
        loginError.textContent = 'Please fill in all fields';
        return;
      }
      
      auth.signInWithEmailAndPassword(email, pass)
        .then((userCredential) => {
          // Login successful
          loginError.textContent = '';
        })
        .catch((error) => {
          loginError.textContent = error.message;
        });
    });

    // Register Function
    registerBtn.addEventListener('click', () => {
      // Validate all fields
      if (!username.value || !name.value || !gender.value || !education.value || 
          !email.value || !password.value || !whatsapp.value || !paymentMethod.value || 
          !paymentNumber.value || !transactionId.value || !datetime.value || !agreeTerms.checked) {
        registerError.textContent = 'Please fill in all fields and agree to terms';
        return;
      }
      
      if (password.value.length < 6) {
        registerError.textContent = 'Password must be at least 6 characters';
        return;
      }
      
      if (paymentNumber.value.length !== 11) {
        registerError.textContent = 'Payment number must be 11 digits';
        return;
      }
      
      // Check for referral code in URL
      const urlParams = new URLSearchParams(window.location.search);
      const urlReferralCode = urlParams.get('ref');
      
      // Use URL referral code if no code was entered in the form
      const referralCode = referral.value || urlReferralCode || '';
      
      // Create user with email and password
      auth.createUserWithEmailAndPassword(email.value, password.value)
        .then((userCredential) => {
          // User created, now save additional info to database
          const user = userCredential.user;
          const userData = {
            username: username.value,
            name: name.value,
            gender: gender.value,
            education: education.value,
            email: email.value,
            whatsapp: whatsapp.value,
            referral: referralCode,
            paymentMethod: paymentMethod.value,
            paymentNumber: paymentNumber.value,
            transactionId: transactionId.value,
            datetime: datetime.value,
            status: 'pending', // pending, approved, rejected
            points: 0, // Initialize points to 0
            balance: 0, // Initialize balance to 0
            createdAt: firebase.database.ServerValue.TIMESTAMP,
            uid: user.uid
          };
          
          // Save user data to database
          database.ref('users/' + user.uid).set(userData)
            .then(() => {
              registerError.textContent = '';
              registerSuccess.textContent = 'Registration successful! Please wait for admin approval.';
              
              // Process referral if any
              if (referralCode) {
                processReferral(referralCode);
              }
              
              // Clear form
              username.value = '';
              name.value = '';
              gender.value = '';
              education.value = '';
              email.value = '';
              password.value = '';
              whatsapp.value = '';
              referral.value = '';
              paymentMethod.value = '';
              paymentNumber.value = '';
              transactionId.value = '';
              datetime.value = '';
              agreeTerms.checked = false;
              
              // Show pending approval screen
              setTimeout(() => {
                showContainer(pendingContainer);
                auth.signOut(); // Logout user until approved
              }, 2000);
            })
            .catch((error) => {
              registerError.textContent = 'Failed to save user data: ' + error.message;
            });
        })
        .catch((error) => {
          registerError.textContent = error.message;
        });
    });

    // Check User Status (pending, approved, admin)
    function checkUserStatus(uid, email) {
      database.ref('users/' + uid).once('value')
        .then((snapshot) => {
          const userData = snapshot.val();
          currentUserData = userData;
          
          // Check if admin
          if (adminEmails.includes(email)) {
            showAdminPanel();
            loadAdminStats();
            loadPendingUsers();
            return;
          }
          
          // Check if user exists and is approved
          if (userData && userData.status === 'approved') {
            // Show dashboard
            showDashboard(userData);
            
            // Check if user reached referral bonus threshold
            checkReferralBonus(uid);
          } else if (userData && userData.status === 'pending') {
            // Show pending approval screen
            showContainer(pendingContainer);
          } else {
            // User data not found or status unknown
            auth.signOut();
            showContainer(loginContainer);
          }
        })
        .catch((error) => {
          console.error('Error checking user status:', error);
          auth.signOut();
          showContainer(loginContainer);
        });
    }

    // Show Dashboard
    function showDashboard(userData) {
      dashboardUsername.textContent = `Welcome, ${userData.username}`;
      showContainer(dashboardContainer);
    }

    // Show Admin Panel
    function showAdminPanel() {
      showContainer(adminDashboard);
      loadAdminStats();
      loadPendingUsers();
    }

    // Load Admin Stats
    function loadAdminStats() {
      database.ref('users').once('value')
        .then((snapshot) => {
          let total = 0;
          let pending = 0;
          let approved = 0;
          let rejected = 0;
          
          snapshot.forEach(childSnapshot => {
            const user = childSnapshot.val();
            total++;
            if (user.status === 'pending') pending++;
            if (user.status === 'approved') approved++;
            if (user.status === 'rejected') rejected++;
          });
          
          totalUsersEl.textContent = total;
          pendingUsersEl.textContent = pending;
          approvedUsersEl.textContent = approved;
        })
        .catch((error) => {
          console.error('Error loading admin stats:', error);
        });
      
      // Load pending withdrawals count
      database.ref('withdrawals').orderByChild('status').equalTo('pending').once('value')
        .then(snapshot => {
          pendingWithdrawalsEl.textContent = snapshot.exists() ? snapshot.numChildren() : 0;
        });
      
      // Load pending screenshots count
      database.ref('screenshots').orderByChild('status').equalTo('pending').once('value')
        .then(snapshot => {
          pendingScreenshotsEl.textContent = snapshot.exists() ? snapshot.numChildren() : 0;
        });
    }

    // Load Pending Users
    function loadPendingUsers() {
      database.ref('users').orderByChild('status').equalTo('pending').once('value')
        .then((snapshot) => {
          pendingList.innerHTML = '';
          
          if (!snapshot.exists()) {
            pendingList.innerHTML = '<p>No pending users</p>';
            return;
          }
          
          snapshot.forEach((childSnapshot) => {
            const user = childSnapshot.val();
            addUserCard(user, pendingList, true);
          });
        })
        .catch((error) => {
          console.error('Error loading pending users:', error);
        });
    }

    // Load Approved Users
    function loadApprovedUsers() {
      database.ref('users').orderByChild('status').equalTo('approved').once('value')
        .then((snapshot) => {
          approvedList.innerHTML = '';
          
          if (!snapshot.exists()) {
            approvedList.innerHTML = '<p>No approved users</p>';
            return;
          }
          
          snapshot.forEach((childSnapshot) => {
            const user = childSnapshot.val();
            addUserCard(user, approvedList, false);
          });
        })
        .catch((error) => {
          console.error('Error loading approved users:', error);
        });
    }

    // Load Rejected Users
    function loadRejectedUsers() {
      database.ref('users').orderByChild('status').equalTo('rejected').once('value')
        .then((snapshot) => {
          rejectedList.innerHTML = '';
          
          if (!snapshot.exists()) {
            rejectedList.innerHTML = '<p>No rejected users</p>';
            return;
          }
          
          snapshot.forEach((childSnapshot) => {
            const user = childSnapshot.val();
            addUserCard(user, rejectedList, false);
          });
        })
        .catch((error) => {
          console.error('Error loading rejected users:', error);
        });
    }

    // Load All Users
    function loadAllUsers() {
      database.ref('users').once('value')
        .then((snapshot) => {
          allList.innerHTML = '';
          
          if (!snapshot.exists()) {
            allList.innerHTML = '<p>No users found</p>';
            return;
          }
          
          snapshot.forEach((childSnapshot) => {
            const user = childSnapshot.val();
            addUserCard(user, allList, user.status === 'pending');
          });
        })
        .catch((error) => {
          console.error('Error loading all users:', error);
        });
    }

    // Load Withdrawal Requests
    function loadWithdrawalRequests() {
      database.ref('withdrawals').orderByChild('status').equalTo('pending').once('value')
        .then((snapshot) => {
          withdrawalsList.innerHTML = '';
          
          if (!snapshot.exists()) {
            withdrawalsList.innerHTML = '<p>No pending withdrawal requests</p>';
            return;
          }
          
          snapshot.forEach((childSnapshot) => {
            const withdrawal = childSnapshot.val();
            addWithdrawalCard(withdrawal, childSnapshot.key);
          });
        });
    }

    // Add User Card to List
    function addUserCard(user, listElement, showActions = true) {
      const userCard = document.createElement('div');
      userCard.className = 'user-card';
      
      const statusClass = user.status === 'pending' ? 'pending' : 
                         user.status === 'approved' ? 'approved' : 'rejected';
      
      userCard.innerHTML = `
        <div class="user-info">
          <div class="user-name">${user.name} (${user.username})</div>
          <div class="user-email">${user.email}</div>
          <div class="user-whatsapp">WhatsApp: ${user.whatsapp}</div>
          <div class="user-payment">Payment: ${user.paymentMethod} (${user.paymentNumber})</div>
          <div class="user-status ${statusClass}">${user.status}</div>
          <div class="user-points">Points: ${user.points || 0}</div>
          <div class="user-balance">Balance: ${user.balance || 0} BDT</div>
        </div>
      `;
      
      if (showActions) {
        const actionButtons = document.createElement('div');
        actionButtons.className = 'action-buttons';
        actionButtons.innerHTML = `
          <button class="action-btn approve-btn" data-uid="${user.uid}">Approve</button>
          <button class="action-btn reject-btn" data-uid="${user.uid}">Reject</button>
          <button class="action-btn view-btn" data-uid="${user.uid}">View</button>
        `;
        userCard.appendChild(actionButtons);
        
        // Add event listeners to buttons
        userCard.querySelector('.approve-btn').addEventListener('click', () => approveUser(user.uid));
        userCard.querySelector('.reject-btn').addEventListener('click', () => rejectUser(user.uid));
        userCard.querySelector('.view-btn').addEventListener('click', () => viewUser(user));
      }
      
      listElement.appendChild(userCard);
    }

    // Add Withdrawal Card to List
    function addWithdrawalCard(withdrawal, withdrawalId) {
      const withdrawalCard = document.createElement('div');
      withdrawalCard.className = 'user-card';
      
      withdrawalCard.innerHTML = `
        <div class="user-info">
          <div class="user-name">${withdrawal.name} (${withdrawal.username})</div>
          <div class="user-email">Method: ${withdrawal.method}</div>
          <div class="user-whatsapp">Account: ${withdrawal.number}</div>
          <div class="user-payment">Amount: ${withdrawal.amount} BDT</div>
          <div class="user-status pending">${withdrawal.status}</div>
        </div>
      `;
      
      const actionButtons = document.createElement('div');
      actionButtons.className = 'action-buttons';
      actionButtons.innerHTML = `
        <button class="action-btn approve-btn" data-withdrawal="${withdrawalId}">Approve</button>
        <button class="action-btn reject-btn" data-withdrawal="${withdrawalId}">Reject</button>
      `;
      withdrawalCard.appendChild(actionButtons);
      
      // Add event listeners to buttons
      withdrawalCard.querySelector('.approve-btn').addEventListener('click', () => processWithdrawal(withdrawalId, 'approved'));
      withdrawalCard.querySelector('.reject-btn').addEventListener('click', () => processWithdrawal(withdrawalId, 'rejected'));
      
      withdrawalsList.appendChild(withdrawalCard);
    }

    // Process Withdrawal (approve/reject)
    function processWithdrawal(withdrawalId, action) {
      database.ref('withdrawals/' + withdrawalId).once('value')
        .then(snapshot => {
          const withdrawal = snapshot.val();
          
          if (action === 'approved') {
            // Deduct balance from user
            database.ref('users/' + withdrawal.userId).once('value')
              .then(userSnapshot => {
                const user = userSnapshot.val();
                const newBalance = (user.balance || 0) - withdrawal.amount;
                
                // Update user balance
                database.ref('users/' + withdrawal.userId).update({ balance: newBalance })
                  .then(() => {
                    // Update withdrawal status
                    database.ref('withdrawals/' + withdrawalId).update({ status: 'approved' })
                      .then(() => {
                        // Record history for user
                        recordHistoryForUser(withdrawal.userId, {
                          type: 'withdrawal',
                          amount: -withdrawal.amount,
                          details: `Withdrawal of ${withdrawal.amount} BDT approved (${withdrawal.method} - ${withdrawal.number})`,
                          timestamp: firebase.database.ServerValue.TIMESTAMP
                        });
                        
                        // Reload withdrawals list
                        loadWithdrawalRequests();
                        loadAdminStats();
                      });
                  });
              });
          } else {
            // Just update withdrawal status to rejected
            database.ref('withdrawals/' + withdrawalId).update({ status: 'rejected' })
              .then(() => {
                // Record history for user
                recordHistoryForUser(withdrawal.userId, {
                  type: 'withdrawal',
                  amount: 0,
                  details: `Withdrawal request of ${withdrawal.amount} BDT rejected`,
                  timestamp: firebase.database.ServerValue.TIMESTAMP
                });
                
                // Reload withdrawals list
                loadWithdrawalRequests();
                loadAdminStats();
              });
          }
        });
    }

    // Approve User
    function approveUser(uid) {
      database.ref('users/' + uid).update({ status: 'approved' })
        .then(() => {
          // Refresh all lists and stats
          loadPendingUsers();
          loadApprovedUsers();
          loadAllUsers();
          loadAdminStats();
          
          // Add welcome points
          addPointsForUser(uid, 100, 'Welcome bonus');
        })
        .catch((error) => {
          console.error('Error approving user:', error);
        });
    }

    // Reject User
    function rejectUser(uid) {
      database.ref('users/' + uid).update({ status: 'rejected' })
        .then(() => {
          // Refresh all lists and stats
          loadPendingUsers();
          loadRejectedUsers();
          loadAllUsers();
          loadAdminStats();
        })
        .catch((error) => {
          console.error('Error rejecting user:', error);
        });
    }

    // View User Details
    function viewUser(user) {
      selectedUserForModal = user;
      modalUserTitle.textContent = `User: ${user.username}`;
      
      modalUserContent.innerHTML = `
        <p><strong>Name:</strong> ${user.name}</p>
        <p><strong>Email:</strong> ${user.email}</p>
        <p><strong>WhatsApp:</strong> ${user.whatsapp}</p>
        <p><strong>Payment Method:</strong> ${user.paymentMethod} (${user.paymentNumber})</p>
        <p><strong>Status:</strong> ${user.status}</p>
        <p><strong>Points:</strong> ${user.points || 0}</p>
        <p><strong>Balance:</strong> ${user.balance || 0} BDT</p>
        <p><strong>Registered:</strong> ${new Date(user.datetime).toLocaleString()}</p>
      `;
      
      showModal();
    }

    // Add Points to User (admin)
    function addUserPoints(uid, points) {
      database.ref('users/' + uid).once('value')
        .then(snapshot => {
          const user = snapshot.val();
          const currentPoints = user.points || 0;
          const newPoints = currentPoints + points;
          
          database.ref('users/' + uid).update({ points: newPoints })
            .then(() => {
              // Record history
              recordHistoryForUser(uid, {
                type: 'admin_points',
                points: points,
                details: `Admin added ${points} points`,
                timestamp: firebase.database.ServerValue.TIMESTAMP
              });
              
              alert(`Successfully added ${points} points to user`);
              
              // Refresh user lists if needed
              if (allList.contains(document.activeElement)) {
                loadAllUsers();
              } else if (approvedList.contains(document.activeElement)) {
                loadApprovedUsers();
              }
            });
        });
    }

    // Remove Points from User (admin)
    function removeUserPoints(uid, points) {
      database.ref('users/' + uid).once('value')
        .then(snapshot => {
          const user = snapshot.val();
          const currentPoints = user.points || 0;
          const newPoints = Math.max(0, currentPoints - points);
          
          database.ref('users/' + uid).update({ points: newPoints })
            .then(() => {
              // Record history
              recordHistoryForUser(uid, {
                type: 'admin_points',
                points: -points,
                details: `Admin removed ${points} points`,
                timestamp: firebase.database.ServerValue.TIMESTAMP
              });
              
              alert(`Successfully removed ${points} points from user`);
              
              // Refresh user lists if needed
              if (allList.contains(document.activeElement)) {
                loadAllUsers();
              } else if (approvedList.contains(document.activeElement)) {
                loadApprovedUsers();
              }
            });
        });
    }

    // Add BDT to User (admin)
    function addUserBdt(uid, amount) {
      database.ref('users/' + uid).once('value')
        .then(snapshot => {
          const user = snapshot.val();
          const currentBalance = user.balance || 0;
          const newBalance = currentBalance + amount;
          
          database.ref('users/' + uid).update({ balance: newBalance })
            .then(() => {
              // Record history
              recordHistoryForUser(uid, {
                type: 'admin_balance',
                amount: amount,
                details: `Admin added ${amount} BDT`,
                timestamp: firebase.database.ServerValue.TIMESTAMP
              });
              
              alert(`Successfully added ${amount} BDT to user`);
              
              // Refresh user lists if needed
              if (allList.contains(document.activeElement)) {
                loadAllUsers();
              } else if (approvedList.contains(document.activeElement)) {
                loadApprovedUsers();
              }
            });
        });
    }

    // Delete User Account
    function deleteUserAccount(uid) {
      // Delete user data
      database.ref('users/' + uid).remove()
        .then(() => {
          // Delete user authentication
          auth.getUser(uid)
            .then(() => {
              // In a real app, you would need backend code to delete the user
              // as client-side JavaScript can't delete users directly
              alert('User data deleted. Note: Authentication record still exists and needs to be deleted from the Firebase console.');
              
              // Refresh user lists
              loadAllUsers();
              loadApprovedUsers();
              loadPendingUsers();
              loadRejectedUsers();
              
              hideModal();
            })
            .catch(error => {
              console.error('Error getting user:', error);
              alert('User data deleted but could not verify authentication record.');
              
              // Refresh user lists
              loadAllUsers();
              loadApprovedUsers();
              loadPendingUsers();
              loadRejectedUsers();
              
              hideModal();
            });
        })
        .catch(error => {
          console.error('Error deleting user:', error);
          alert('Failed to delete user data');
        });
    }

    // Add Welcome Points to User
    function addPointsForUser(uid, points, reason) {
      database.ref('users/' + uid).once('value')
        .then(snapshot => {
          const user = snapshot.val();
          const currentPoints = user.points || 0;
          const newPoints = currentPoints + points;
          
          database.ref('users/' + uid).update({ points: newPoints })
            .then(() => {
              // Record history
              recordHistoryForUser(uid, {
                type: 'system',
                points: points,
                details: reason,
                timestamp: firebase.database.ServerValue.TIMESTAMP
              });
            });
        });
    }

    // Logout Function
    function logout() {
      auth.signOut()
        .then(() => {
          showContainer(loginContainer);
        })
        .catch((error) => {
          console.error('Error logging out:', error);
        });
    }

    // Initialize - show login by default
    showContainer(loginContainer);
    
    // Set current datetime for registration form
    const now = new Date();
    datetime.value = now.toISOString().slice(0, 16);
  </script>
</body>
</html>