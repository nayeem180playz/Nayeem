<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EarnWalk - Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    /* Common Styles */
    .container {
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .form-container {
      padding: 30px;
    }

    .title {
      text-align: center;
      margin-bottom: 20px;
      color: #333;
      font-size: 24px;
      font-weight: 600;
    }

    .input-group {
      margin-bottom: 15px;
    }

    .input-group label {
      display: block;
      margin-bottom: 5px;
      font-size: 14px;
      color: #555;
    }

    .input-group input, .input-group select {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.3s;
    }

    .input-group input:focus, .input-group select:focus {
      border-color: #8e2de2;
      outline: none;
    }

    .btn {
      width: 100%;
      padding: 12px;
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      margin-top: 10px;
    }

    .btn:hover {
      opacity: 0.9;
      transform: translateY(-2px);
    }

    .toggle-form {
      text-align: center;
      margin-top: 20px;
      font-size: 14px;
      color: #555;
    }

    .toggle-form a {
      color: #8e2de2;
      text-decoration: none;
      font-weight: 500;
    }

    .error-message {
      color: #ff4757;
      font-size: 13px;
      margin-top: 5px;
      text-align: center;
    }

    .success-message {
      color: #2ed573;
      font-size: 13px;
      margin-top: 5px;
      text-align: center;
    }

    /* Pending Approval Styles */
    .pending-container {
      padding: 30px;
      text-align: center;
    }

    .pending-title {
      color: #8e2de2;
      font-size: 22px;
      margin-bottom: 20px;
    }

    .pending-message {
      background: #f8f8f8;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      font-size: 14px;
      color: #555;
      line-height: 1.6;
    }

    .contact-info {
      margin-top: 30px;
      font-size: 14px;
      color: #555;
    }

    .contact-info a {
      color: #8e2de2;
      text-decoration: none;
    }

    /* Dashboard Styles */
    .dashboard-container {
      display: none;
      width: 100%;
      max-width: 500px;
      margin: 20px 0;
    }

    .header {
      background: white;
      padding: 15px;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      border-radius: 15px;
      margin-bottom: 20px;
    }

    .username {
      font-size: 18px;
      font-weight: 600;
      color: #333;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      padding: 0 20px 20px;
    }

    .card {
      background: white;
      border-radius: 10px;
      padding: 15px 5px;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
      opacity: 0;
      transform: translateY(50px);
      animation: fadeInUp 0.6s forwards;
    }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card:nth-child(1) { animation-delay: 0.1s; }
    .card:nth-child(2) { animation-delay: 0.2s; }
    .card:nth-child(3) { animation-delay: 0.3s; }
    .card:nth-child(4) { animation-delay: 0.4s; }
    .card:nth-child(5) { animation-delay: 0.5s; }
    .card:nth-child(6) { animation-delay: 0.6s; }
    .card:nth-child(7) { animation-delay: 0.7s; }
    .card:nth-child(8) { animation-delay: 0.8s; }
    .card:nth-child(9) { animation-delay: 0.9s; }
    .card:nth-child(10){ animation-delay: 1s; }
    .card:nth-child(11){ animation-delay: 1.1s; }
    .card:nth-child(12){ animation-delay: 1.2s; }

    .card:hover {
      transform: scale(1.05);
    }

    .card img {
      width: 39px;
      height: 39px;
    }

    .card p {
      margin: 9px 0 0;
      font-weight: bold;
      font-size: 15px;
    }

    .logout-btn {
      background: #ff4757;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      margin: 20px auto;
      display: block;
      font-size: 16px;
      font-weight: 500;
      transition: all 0.3s;
    }

    .logout-btn:hover {
      opacity: 0.9;
    }

    /* Admin Panel Styles */
    .admin-dashboard {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .admin-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .admin-title {
      font-size: 20px;
      font-weight: 600;
    }

    .admin-nav {
      display: flex;
      background: #f8f8f8;
      border-bottom: 1px solid #eee;
      overflow-x: auto;
      white-space: nowrap;
    }

    .admin-nav-item {
      padding: 15px 20px;
      cursor: pointer;
      font-weight: 500;
      color: #555;
      border-bottom: 3px solid transparent;
      transition: all 0.3s;
    }

    .admin-nav-item.active {
      color: #8e2de2;
      border-bottom-color: #8e2de2;
      background: #fff;
    }

    .admin-content {
      padding: 20px;
      min-height: 300px;
    }

    .admin-section {
      display: none;
    }

    .admin-section.active {
      display: block;
    }

    .user-list {
      margin-top: 20px;
    }

    .user-card {
      background: #f8f8f8;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }

    .user-info {
      flex: 1;
      min-width: 200px;
    }

    .user-name {
      font-weight: 600;
    }

    .user-email {
      font-size: 12px;
      color: #555;
    }

    .user-status {
      font-size: 12px;
      padding: 3px 8px;
      border-radius: 10px;
      background: #ddd;
      color: #333;
    }

    .user-status.pending {
      background: #ffa502;
      color: white;
    }

    .user-status.approved {
      background: #2ed573;
      color: white;
    }

    .user-status.rejected {
      background: #ff4757;
      color: white;
    }

    .action-buttons {
      display: flex;
      gap: 5px;
      margin-top: 10px;
    }

    .action-btn {
      padding: 8px 12px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      transition: all 0.3s;
    }

    .approve-btn {
      background: #2ed573;
      color: white;
    }

    .reject-btn {
      background: #ff4757;
      color: white;
    }

    .view-btn {
      background: #3498db;
      color: white;
    }

    .stats-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }

    .stat-card {
      background: #f8f8f8;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
    }

    .stat-value {
      font-size: 24px;
      font-weight: 600;
      color: #8e2de2;
    }

    .stat-label {
      font-size: 14px;
      color: #555;
    }

    /* Work Menu Styles */
    .work-menu-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .work-menu-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .work-menu-content {
      padding: 15px;
      max-height: 500px;
      overflow-y: auto;
    }

    .menu-item {
      background: #d4e9ff;
      margin: 10px 0;
      padding: 10px 15px;
      border-radius: 30px;
      color: #333;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      transform: translateX(-20px);
      opacity: 0;
      animation: slideIn 0.5s forwards;
    }

    @keyframes slideIn {
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .menu-item:nth-child(1) { animation-delay: 0.1s; }
    .menu-item:nth-child(2) { animation-delay: 0.2s; }
    .menu-item:nth-child(3) { animation-delay: 0.3s; }
    .menu-item:nth-child(4) { animation-delay: 0.4s; }
    .menu-item:nth-child(5) { animation-delay: 0.5s; }
    .menu-item:nth-child(6) { animation-delay: 0.6s; }
    .menu-item:nth-child(7) { animation-delay: 0.7s; }
    .menu-item:nth-child(8) { animation-delay: 0.8s; }
    .menu-item:nth-child(9) { animation-delay: 0.9s; }
    .menu-item:nth-child(10) { animation-delay: 1.0s; }

    .menu-item:hover {
      background: #a7ccff;
      transition: 0.3s;
    }

    .menu-icon {
      color: #ff2fbf;
    }

    .back-btn {
      background: #3498db;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 15px;
      font-weight: 500;
      transition: all 0.3s;
    }

    .back-btn:hover {
      opacity: 0.9;
    }

    /* Help Line Styles */
    .help-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .help-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .help-content {
      padding: 20px;
      background: linear-gradient(to bottom right, #ff2fbf, #8e2de2);
      color: white;
      text-align: center;
    }

    .help-box {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 19px;
      width: 100%;
      text-align: center;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
      animation: fadeIn 1s ease forwards;
      opacity: 0;
      transform: translateY(30px);
    }

    @keyframes fadeIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .help-content h2 {
      margin-bottom: 20px;
      font-size: 24px;
    }

    .link-button {
      display: block;
      background: #fff;
      color: #8e2de2;
      margin: 10px 0;
      padding: 12px 20px;
      border-radius: 30px;
      text-decoration: none;
      font-weight: bold;
      transition: all 0.3s;
    }

    .link-button:hover {
      background: #8e2de2;
      color: #fff;
      transform: scale(1.05);
    }

    .whatsapp {
      margin-top: 20px;
      font-size: 18px;
    }

    .whatsapp span {
      display: inline-block;
      animation: pulse 1s infinite alternate;
    }

    @keyframes pulse {
      from { transform: scale(1); }
      to { transform: scale(1.1); color: #00ffcc; }
    }

    .name-link {
      margin-top: 10px;
      font-size: 20px;
      font-weight: bold;
      color: #fff;
      text-decoration: none;
      transition: color 0.3s ease;
      display: block;
    }

    .name-link:hover {
      color: #000;
      text-decoration: underline;
    }

    /* Profile Level Styles */
    .profile-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .profile-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .profile-content {
      padding: 20px;
    }

    .level-container {
      text-align: center;
      margin-bottom: 20px;
    }

    .level-display {
      font-size: 24px;
      font-weight: bold;
      color: #8e2de2;
      margin-bottom: 10px;
    }

    .points-display {
      font-size: 18px;
      color: #555;
      margin-bottom: 20px;
    }

    .progress-container {
      width: 100%;
      height: 20px;
      background: #f0f0f0;
      border-radius: 10px;
      margin-bottom: 20px;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      border-radius: 10px;
      transition: width 0.5s ease;
    }

    .level-rewards {
      margin-top: 20px;
    }

    .reward-item {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      padding: 10px;
      background: #f8f8f8;
      border-radius: 8px;
    }

    .reward-icon {
      width: 30px;
      height: 30px;
      margin-right: 10px;
      color: #8e2de2;
    }

    .reward-text {
      flex: 1;
      font-size: 14px;
    }

    .reward-achieved {
      color: #2ed573;
      font-weight: bold;
    }

    /* Referral Styles */
    .referral-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .referral-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .referral-content {
      padding: 20px;
    }

    .referral-code-box {
      background: #f8f8f8;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      margin-bottom: 20px;
    }

    .referral-code {
      font-size: 24px;
      font-weight: bold;
      color: #8e2de2;
      margin: 10px 0;
    }

    .copy-btn {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s;
      margin-top: 10px;
    }

    .copy-btn:hover {
      opacity: 0.9;
    }

    .referral-stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }

    .stat-box {
      background: #f8f8f8;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
    }

    .stat-value {
      font-size: 20px;
      font-weight: bold;
      color: #8e2de2;
    }

    .stat-label {
      font-size: 14px;
      color: #555;
    }

    .referral-link {
      margin-top: 20px;
      padding: 15px;
      background: #f0f0f0;
      border-radius: 10px;
      word-break: break-all;
    }

    .history-container {
      margin-top: 20px;
      max-height: 300px;
      overflow-y: auto;
    }

    .history-item {
      background: #f8f8f8;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 10px;
      font-size: 14px;
    }

    .history-item .date {
      font-size: 12px;
      color: #777;
      margin-top: 5px;
    }

    /* History Styles */
    .history-container-full {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .history-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .history-content {
      padding: 20px;
      max-height: 500px;
      overflow-y: auto;
    }

    .history-list {
      margin-top: 15px;
    }

    .history-entry {
      background: #f8f8f8;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .history-type {
      font-weight: bold;
      color: #8e2de2;
    }

    .history-details {
      margin-top: 5px;
      font-size: 14px;
    }

    .history-date {
      font-size: 12px;
      color: #777;
      margin-top: 5px;
      text-align: right;
    }

    /* Notice Board Styles */
    .notice-container {
      display: none;
      width: 100%;
      max-width: 500px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      margin: 20px 0;
    }

    .notice-header {
      background: linear-gradient(to right, #ff2fbf, #8e2de2);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .notice-content {
      padding: 20px;
      background: linear-gradient(to bottom right, #ff2fbf, #8e2de2);
      color: white;
      text-align: center;
    }

    .notice-box {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 19px;
      width: 100%;
      text-align: left;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
      animation: fadeIn 1s ease forwards;
      opacity: 0;
      transform: translateY(30px);
    }

    .notice-box h2 {
      text-align: center;
      margin-bottom: 15px;
    }

    .notice-box p {
      margin-bottom: 10px;
      line-height: 1.5;
    }

    /* Responsive Styles */
    @media (max-width: 500px) {
      .grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .stats-container {
        grid-template-columns: 1fr;
      }
      
      .admin-nav {
        flex-wrap: wrap;
      }
      
      .admin-nav-item {
        padding: 10px 15px;
        font-size: 14px;
      }
      
      .user-card {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .action-buttons {
        align-self: flex-end;
      }

      .menu-item {
        padding: 12px 15px;
        font-size: 14px;
      }

      .referral-stats {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 350px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Login Container -->
  <div class="container" id="loginContainer">
    <div class="form-container">
      <h2 class="title">Login</h2>
      <div id="loginError" class="error-message"></div>
      <div class="input-group">
        <label for="loginEmail">Email</label>
        <input type="email" id="loginEmail" placeholder="Enter your email">
      </div>
      <div class="input-group">
        <label for="loginPassword">Password</label>
        <input type="password" id="loginPassword" placeholder="Enter your password">
      </div>
      <button class="btn" id="loginBtn">Login</button>
      <div class="toggle-form">
        Don't have an account? <a href="#" id="showRegister">Register</a>
      </div>
    </div>
  </div>

  <!-- Registration Container -->
  <div class="container" id="registerContainer" style="display: none;">
    <div class="form-container">
      <h2 class="title">Registration</h2>
      <div id="registerError" class="error-message"></div>
      <div id="registerSuccess" class="success-message"></div>
      
      <div class="input-group">
        <label for="username">Username</label>
        <input type="text" id="username" placeholder="Enter username">
      </div>
      
      <div class="input-group">
        <label for="name">Name</label>
        <input type="text" id="name" placeholder="Enter your full name">
      </div>
      
      <div class="input-group">
        <label for="gender">Choose Your Gender</label>
        <select id="gender">
          <option value="">Select Gender</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Other">Other</option>
        </select>
      </div>
      
      <div class="input-group">
        <label for="education">Choose Your Education</label>
        <select id="education">
          <option value="">Select Education</option>
          <option value="JSC">JSC</option>
          <option value="SSC">SSC</option>
          <option value="HSC">HSC</option>
          <option value="BSc">BSc</option>
          <option value="MSc">MSc</option>
          <option value="NONE">NONE</option>
        </select>
      </div>
      
      <div class="input-group">
        <label for="email">Email</label>
        <input type="email" id="email" placeholder="Enter your email">
      </div>
      
      <div class="input-group">
        <label for="password">Password</label>
        <input type="password" id="password" placeholder="Create a password">
      </div>
      
      <div class="input-group">
        <label for="whatsapp">WhatsApp Number</label>
        <input type="text" id="whatsapp" placeholder="Enter WhatsApp number">
      </div>
      
      <div class="input-group">
        <label for="referral">Referral Code (Optional)</label>
        <input type="text" id="referral" placeholder="Enter referral code if any">
      </div>
      
      <div class="input-group">
        <label for="paymentMethod">Choose Your payment method</label>
        <select id="paymentMethod">
          <option value="">Select Payment Method</option>
          <option value="Bkash">Bkash</option>
          <option value="Nagad">Nagad</option>
          <option value="Rocket">Rocket</option>
          <option value="Upay">Upay</option>
          <option value="Others">Others</option>
        </select>
      </div>
      
      <div class="input-group">
        <label for="paymentNumber">Payment Number (11 digits)</label>
        <input type="text" id="paymentNumber" placeholder="Enter payment number">
      </div>
      
      <div class="input-group">
        <label for="transactionId">Transaction ID (TrixId)</label>
        <input type="text" id="transactionId" placeholder="Enter transaction ID">
      </div>
      
      <div class="input-group">
        <label for="datetime">Date and Time</label>
        <input type="datetime-local" id="datetime">
      </div>
      
      <div class="input-group" style="display: flex; align-items: center;">
        <input type="checkbox" id="agreeTerms" style="width: auto; margin-right: 10px;">
        <label for="agreeTerms" style="margin-bottom: 0;">I agree to the terms and conditions</label>
      </div>
      
      <button class="btn" id="registerBtn">Register</button>
      <div class="toggle-form">
        Already have an account? <a href="#" id="showLogin">Login</a>
      </div>
    </div>
  </div>

  <!-- Pending Approval Container -->
  <div class="container" id="pendingContainer" style="display: none;">
    <div class="pending-container">
      <h2 class="pending-title">Pending Request</h2>
      <div class="pending-message">
        Please wait while admin reviews your registration request. Admin will approve your request within 24 hours. If you face any issues, please contact admin via WhatsApp using the number below.
      </div>
      <div class="contact-info">
        Contact Admin: <a href="https://wa.me/1234567890">WhatsApp</a>
      </div>
    </div>
  </div>

  <!-- Dashboard Container -->
  <div class="dashboard-container" id="dashboardContainer" style="display: none;">
    <div class="header">
      <div class="username" id="dashboardUsername">Welcome, User</div>
    </div>
    <div class="grid">
      <a href="#" class="card" id="profileCard">
        <img src="https://img.icons8.com/ios/50/checked-user-male.png" alt="Profile">
        <p>Profile Level</p>
      </a>

      <a href="#" class="card" id="workCard">
        <img src="https://img.icons8.com/ios/50/briefcase.png" alt="Work">
        <p>My Work</p>
      </a>

      <a href="#" class="card" id="helpCard">
        <img src="https://img.icons8.com/ios/50/help.png" alt="Help">
        <p>Help Line</p>
      </a>

      <a href="#" class="card" id="referCard">
        <img src="https://img.icons8.com/ios/50/share.png" alt="Refer">
        <p>Refer</p>
      </a>

      <a href="withdraw.html" class="card">
        <img src="https://img.icons8.com/ios/50/money.png" alt="Withdraw">
        <p>Withdraw</p>
      </a>

      <a href="screenshot.html" class="card">
        <img src="https://img.icons8.com/ios/50/image.png" alt="Screenshot">
        <p>Screenshot</p>
      </a>

      <a href="offer.html" class="card">
        <img src="https://img.icons8.com/ios/50/email-open.png" alt="Offer">
        <p>Offer</p>
      </a>

      <a href="#" class="card" id="historyCard">
        <img src="https://img.icons8.com/ios/50/time-machine.png" alt="History">
        <p>History</p>
      </a>

      <a href="balance.html" class="card">
        <img src="https://img.icons8.com/ios/50/money-bag.png" alt="Balance">
        <p>Balance</p>
      </a>

      <a href="leaderboard.html" class="card">
        <img src="https://img.icons8.com/ios/50/paypal.png" alt="Leaderboard">
        <p>Leaderboard</p>
      </a>

      <a href="#" class="card" id="noticeCard">
        <img src="https://img.icons8.com/ios/50/megaphone.png" alt="Notice">
        <p>Notice Board</p>
      </a>

      <a href="#" class="card" id="noticeCard2">
        <img src="https://img.icons8.com/ios/50/megaphone.png" alt="Notice 2">
        <p>Notice Board</p>
      </a>
    </div>
    <button class="logout-btn" id="logoutBtn">Logout</button>
  </div>

  <!-- Work Menu Container -->
  <div class="work-menu-container" id="workMenuContainer">
    <div class="work-menu-header">
      My Work Menu
    </div>
    <div class="work-menu-content">
      <div class="menu-item"><span class="menu-icon">??</span>1. Tiktok Like Follow</div>
      <div class="menu-item"><span class="menu-icon">??</span>2. Gmail Work</div>
      <div class="menu-item"><span class="menu-icon">??</span>3. Facebook Work</div>
      <div class="menu-item"><span class="menu-icon">??</span>4. Refer Generation</div>
      <div class="menu-item"><span class="menu-icon">??</span>5. Typing</div>
      <div class="menu-item"><span class="menu-icon">??</span>6. Watch Video</div>
      <div class="menu-item"><span class="menu-icon">??</span>7. VK Surfing</div>
      <div class="menu-item"><span class="menu-icon">??</span>8. Getlike Work</div>
      <div class="menu-item"><span class="menu-icon">??</span>9. Website Visit Work</div>
      <div class="menu-item"><span class="menu-icon">??</span>10. Seleary</div>
    </div>
    <button class="back-btn" id="backToDashboardBtn">Back to Dashboard</button>
  </div>

  <!-- Help Line Container -->
  <div class="help-container" id="helpContainer">
    <div class="help-header">
      Help Line
    </div>
    <div class="help-content">
      <div class="help-box">
        <h2>?? Help Line</h2>
        <p>???? ????? ????? ????? ????? ???</p>
        <a href="https://chat.whatsapp.com/yourgroup" class="link-button" target="_blank">Join WhatsApp Group</a>

        <br/>
        <h1>??Tainner</h1>

        <!-- ? ??? ? ????? ???? WhatsApp ???? ??? -->
        <a href="https://wa.me/8801XXXXXXXXX" target="_blank" class="name-link">
          Mahi chy
        </a>
        
        <br/>
        <!-- ? ??? ? ????? ???? WhatsApp ???? ??? -->
        <a href="https://wa.me/8801XXXXXXXXX" target="_blank" class="name-link">
          Rahim chy
        </a>
      </div>
      <button class="back-btn" id="backToDashboardFromHelpBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- Profile Level Container -->
  <div class="profile-container" id="profileContainer">
    <div class="profile-header">
      Profile Level
    </div>
    <div class="profile-content">
      <div class="level-container">
        <div class="level-display" id="levelDisplay">Level 1</div>
        <div class="points-display" id="pointsDisplay">0 Points</div>
        <div class="progress-container">
          <div class="progress-bar" id="progressBar" style="width: 0%"></div>
        </div>
      </div>
      
      <div class="level-rewards">
        <h3>Level Rewards</h3>
        <div class="reward-item">
          <div class="reward-icon">??</div>
          <div class="reward-text">Level 1: Start your journey (0 points)</div>
          <div class="reward-achieved" id="level1Reward">?</div>
        </div>
        <div class="reward-item">
          <div class="reward-icon">??</div>
          <div class="reward-text">Level 2: Reach 10 points</div>
          <div class="reward-achieved" id="level2Reward">?</div>
        </div>
        <div class="reward-item">
          <div class="reward-icon">??</div>
          <div class="reward-text">Level 3: Reach 20 points</div>
          <div class="reward-achieved" id="level3Reward">?</div>
        </div>
        <div class="reward-item">
          <div class="reward-icon">??</div>
          <div class="reward-text">Level 4: Reach 40 points</div>
          <div class="reward-achieved" id="level4Reward">?</div>
        </div>
        <div class="reward-item">
          <div class="reward-icon">??</div>
          <div class="reward-text">Level 5: Reach 50 points</div>
          <div class="reward-achieved" id="level5Reward">?</div>
        </div>
      </div>
      
      <button class="back-btn" id="backToDashboardFromProfileBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- Referral Container -->
  <div class="referral-container" id="referralContainer">
    <div class="referral-header">
      Referral Program
    </div>
    <div class="referral-content">
      <div class="referral-code-box">
        <p>Your Referral Code</p>
        <div class="referral-code" id="referralCodeDisplay">Loading...</div>
        <button class="copy-btn" id="copyReferralBtn">Copy Code</button>
      </div>
      
      <div class="referral-stats">
        <div class="stat-box">
          <div class="stat-value" id="totalReferrals">0</div>
          <div class="stat-label">Total Referrals</div>
        </div>
        <div class="stat-box">
          <div class="stat-value" id="referralPoints">0</div>
          <div class="stat-label">Points Earned</div>
        </div>
      </div>
      
      <div>
        <p>Your Referral Link:</p>
        <div class="referral-link" id="referralLink">Loading...</div>
      </div>
      
      <div class="history-container">
        <h3>Recent Referral Activity</h3>
        <div id="referralHistoryList">
          <!-- Referral history will be populated here -->
        </div>
      </div>
      
      <button class="back-btn" id="backToDashboardFromReferralBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- History Container -->
  <div class="history-container-full" id="historyContainer">
    <div class="history-header">
      My History
    </div>
    <div class="history-content">
      <div class="history-list" id="historyList">
        <!-- History items will be populated here -->
      </div>
      <button class="back-btn" id="backToDashboardFromHistoryBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- Notice Board Container -->
  <div class="notice-container" id="noticeContainer">
    <div class="notice-header">
      Notice Board
    </div>
    <div class="notice-content">
      <div class="notice-box">
        <h2>Level 1</h2>
        <p>নিচের দেওয়া সকল নিয়ম গুলো মেনে কাজ করবেন নয়তো আপনাকে ট্রেনিং গ্রুপ থেকে রিমুভ করা হবে এবং আপনার আইডি সাসপেন্ড করা হবে....!!❌</p>
        <p>১। অ্যাডমিনদের  স্যার/ ম্যাম বলে ডাকতে হবে।অ্যাডমিদের সাথে খারাপ ব্যবহার করলে গ্রুপ থেকে রিমুভ করা হবে।</p>
        <p>২। এই গ্রুপের কোনো মেম্বার কে পার্সোনাল ভাবে মেসেজ দিবেন না,,যদি মেসেজ দেন তাহলে গ্রুপ থেকে রিমুভ করা হবে।</p> 
        <p>৩।ট্রেইনার এডমিন কে যে মেসেজ গুলো কখনোই করবেন না : Hii, Hello,Hlw, Admin achen, apni ki achen vaiya,,, এমন মেসেজ দেওয়া যাবে না।</p>
        <p>৪।  আপনাকে যে ভিডিও গুলো দেওয়া হবে মনোযোগ দিয়ে দেখবেন,, কোনো রকম সমস্যা হলে স্কিন শর্ট দিয়ে অ্যাডমিনদের কে জানাবেন,,এ ছাড়া গ্রুপ এ অযথা কোনো কথা বলবেন না।</p>
        <p>৫। আমাদের সাইটের কাজ ব্যতিত অন্য কোনো সাইটের কাজের কথা বা কোনো মেম্বার কে কাজের অফার দিলে আপনার আইডি সাসপেন্ড করা হবে।</p>
        <p>উপরের দেওয়া সকল নিয়ম গুলো সবাই মেনে চলবেন। ধন্যবাদ*</p>
      </div>
      <button class="back-btn" id="backToDashboardFromNoticeBtn">Back to Dashboard</button>
    </div>
  </div>

  <!-- Admin Dashboard -->
  <div class="admin-dashboard" id="adminDashboard" style="display: none;">
    <div class="admin-header">
      <div class="admin-title">Admin Panel</div>
      <button class="logout-btn" id="adminLogoutBtn">Logout</button>
    </div>
    
    <div class="admin-nav">
      <div class="admin-nav-item active" data-section="dashboard">Dashboard</div>
      <div class="admin-nav-item" data-section="pending">Pending Requests</div>
      <div class="admin-nav-item" data-section="approved">Approved Users</div>
      <div class="admin-nav-item" data-section="rejected">Rejected Users</div>
      <div class="admin-nav-item" data-section="all">All Users</div>
    </div>
    
    <div class="admin-content">
      <!-- Dashboard Section -->
      <div class="admin-section active" id="dashboardSection">
        <h2>Admin Dashboard</h2>
        <div class="stats-container">
          <div class="stat-card">
            <div class="stat-value" id="totalUsers">0</div>
            <div class="stat-label">Total Users</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="pendingUsers">0</div>
            <div class="stat-label">Pending Users</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="approvedUsers">0</div>
            <div class="stat-label">Approved Users</div>
          </div>
        </div>
      </div>
      
      <!-- Pending Requests Section -->
      <div class="admin-section" id="pendingSection">
        <h2>Pending Requests</h2>
        <div id="pendingList" class="user-list">
          <!-- Pending users will be populated here -->
        </div>
      </div>
      
      <!-- Approved Users Section -->
      <div class="admin-section" id="approvedSection">
        <h2>Approved Users</h2>
        <div id="approvedList" class="user-list">
          <!-- Approved users will be populated here -->
        </div>
      </div>
      
      <!-- Rejected Users Section -->
      <div class="admin-section" id="rejectedSection">
        <h2>Rejected Users</h2>
        <div id="rejectedList" class="user-list">
          <!-- Rejected users will be populated here -->
        </div>
      </div>
      
      <!-- All Users Section -->
      <div class="admin-section" id="allSection">
        <h2>All Users</h2>
        <div id="allList" class="user-list">
          <!-- All users will be populated here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
  
  <script>
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyAVwVzvV0eAcJ3d3X5iQGXkldWSIj4CJe0",
      authDomain: "earnwab.firebaseapp.com",
      databaseURL: "https://earnwab-default-rtdb.firebaseio.com",
      projectId: "earnwab",
      storageBucket: "earnwab.appspot.com",
      messagingSenderId: "341915592864",
      appId: "1:341915592864:web:f68363b7116b2a1cd741c5",
      measurementId: "G-QNJYEQPZ1B"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const database = firebase.database();

    // DOM Elements
    const loginContainer = document.getElementById('loginContainer');
    const registerContainer = document.getElementById('registerContainer');
    const pendingContainer = document.getElementById('pendingContainer');
    const dashboardContainer = document.getElementById('dashboardContainer');
    const workMenuContainer = document.getElementById('workMenuContainer');
    const helpContainer = document.getElementById('helpContainer');
    const profileContainer = document.getElementById('profileContainer');
    const referralContainer = document.getElementById('referralContainer');
    const historyContainer = document.getElementById('historyContainer');
    const noticeContainer = document.getElementById('noticeContainer');
    const adminDashboard = document.getElementById('adminDashboard');
    
    const showRegister = document.getElementById('showRegister');
    const showLogin = document.getElementById('showLogin');
    
    const loginBtn = document.getElementById('loginBtn');
    const registerBtn = document.getElementById('registerBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const adminLogoutBtn = document.getElementById('adminLogoutBtn');
    const backToDashboardBtn = document.getElementById('backToDashboardBtn');
    const backToDashboardFromHelpBtn = document.getElementById('backToDashboardFromHelpBtn');
    const backToDashboardFromProfileBtn = document.getElementById('backToDashboardFromProfileBtn');
    const backToDashboardFromReferralBtn = document.getElementById('backToDashboardFromReferralBtn');
    const backToDashboardFromHistoryBtn = document.getElementById('backToDashboardFromHistoryBtn');
    const backToDashboardFromNoticeBtn = document.getElementById('backToDashboardFromNoticeBtn');
    const workCard = document.getElementById('workCard');
    const helpCard = document.getElementById('helpCard');
    const profileCard = document.getElementById('profileCard');
    const referCard = document.getElementById('referCard');
    const historyCard = document.getElementById('historyCard');
    const noticeCard = document.getElementById('noticeCard');
    const noticeCard2 = document.getElementById('noticeCard2');
    
    const loginEmail = document.getElementById('loginEmail');
    const loginPassword = document.getElementById('loginPassword');
    
    const username = document.getElementById('username');
    const name = document.getElementById('name');
    const gender = document.getElementById('gender');
    const education = document.getElementById('education');
    const email = document.getElementById('email');
    const password = document.getElementById('password');
    const whatsapp = document.getElementById('whatsapp');
    const referral = document.getElementById('referral');
    const paymentMethod = document.getElementById('paymentMethod');
    const paymentNumber = document.getElementById('paymentNumber');
    const transactionId = document.getElementById('transactionId');
    const datetime = document.getElementById('datetime');
    const agreeTerms = document.getElementById('agreeTerms');
    
    const loginError = document.getElementById('loginError');
    const registerError = document.getElementById('registerError');
    const registerSuccess = document.getElementById('registerSuccess');
    
    const dashboardUsername = document.getElementById('dashboardUsername');
    
    // Referral elements
    const referralCodeDisplay = document.getElementById('referralCodeDisplay');
    const copyReferralBtn = document.getElementById('copyReferralBtn');
    const referralLink = document.getElementById('referralLink');
    const totalReferrals = document.getElementById('totalReferrals');
    const referralPoints = document.getElementById('referralPoints');
    const referralHistoryList = document.getElementById('referralHistoryList');
    
    // History elements
    const historyList = document.getElementById('historyList');
    
    // Profile level elements
    const levelDisplay = document.getElementById('levelDisplay');
    const pointsDisplay = document.getElementById('pointsDisplay');
    const progressBar = document.getElementById('progressBar');
    const level1Reward = document.getElementById('level1Reward');
    const level2Reward = document.getElementById('level2Reward');
    const level3Reward = document.getElementById('level3Reward');
    const level4Reward = document.getElementById('level4Reward');
    const level5Reward = document.getElementById('level5Reward');
    
    // Admin elements
    const adminNavItems = document.querySelectorAll('.admin-nav-item');
    const adminSections = document.querySelectorAll('.admin-section');
    const pendingList = document.getElementById('pendingList');
    const approvedList = document.getElementById('approvedList');
    const rejectedList = document.getElementById('rejectedList');
    const allList = document.getElementById('allList');
    const totalUsersEl = document.getElementById('totalUsers');
    const pendingUsersEl = document.getElementById('pendingUsers');
    const approvedUsersEl = document.getElementById('approvedUsers');

    // Admin emails
    const adminEmails = ['admin@earnwalk.com', 'dev123@gmail.com'];

    // Level thresholds
    const levelThresholds = [0, 10, 20, 40, 50]; // Points needed for each level

    // Referral points
    const REFERRAL_SIGNUP_POINTS = 2;
    const REFERRAL_BONUS_POINTS = 5;
    const REFERRAL_BONUS_THRESHOLD = 10;

    // Current user data
    let currentUser = null;
    let currentUserData = null;

    // Show/Hide Containers
    function showContainer(container) {
      loginContainer.style.display = 'none';
      registerContainer.style.display = 'none';
      pendingContainer.style.display = 'none';
      dashboardContainer.style.display = 'none';
      workMenuContainer.style.display = 'none';
      helpContainer.style.display = 'none';
      profileContainer.style.display = 'none';
      referralContainer.style.display = 'none';
      historyContainer.style.display = 'none';
      noticeContainer.style.display = 'none';
      adminDashboard.style.display = 'none';
      
      if (container) {
        container.style.display = 'block';
      }
    }

    // Event Listeners
    showRegister.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(registerContainer);
    });
    
    showLogin.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(loginContainer);
    });
    
    logoutBtn.addEventListener('click', logout);
    adminLogoutBtn.addEventListener('click', logout);
    backToDashboardBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromHelpBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromProfileBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromReferralBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromHistoryBtn.addEventListener('click', () => showContainer(dashboardContainer));
    backToDashboardFromNoticeBtn.addEventListener('click', () => showContainer(dashboardContainer));
    
    workCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(workMenuContainer);
    });

    helpCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(helpContainer);
    });

    profileCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(profileContainer);
      updateProfileLevelDisplay();
    });

    referCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(referralContainer);
      loadReferralInfo();
    });

    historyCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(historyContainer);
      loadUserHistory();
    });

    noticeCard.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(noticeContainer);
    });

    noticeCard2.addEventListener('click', (e) => {
      e.preventDefault();
      showContainer(noticeContainer);
    });

    // Copy referral code
    copyReferralBtn.addEventListener('click', () => {
      navigator.clipboard.writeText(referralCodeDisplay.textContent)
        .then(() => {
          const originalText = copyReferralBtn.textContent;
          copyReferralBtn.textContent = 'Copied!';
          setTimeout(() => {
            copyReferralBtn.textContent = originalText;
          }, 2000);
        })
        .catch(err => {
          console.error('Failed to copy text: ', err);
        });
    });

    // Admin navigation
    adminNavItems.forEach(item => {
      item.addEventListener('click', () => {
        // Remove active class from all items
        adminNavItems.forEach(navItem => navItem.classList.remove('active'));
        // Add active class to clicked item
        item.classList.add('active');
        
        // Hide all sections
        adminSections.forEach(section => section.classList.remove('active'));
        // Show the selected section
        const sectionId = item.dataset.section + 'Section';
        document.getElementById(sectionId).classList.add('active');
        
        // Load data for the section if needed
        if (item.dataset.section === 'pending') {
          loadPendingUsers();
        } else if (item.dataset.section === 'approved') {
          loadApprovedUsers();
        } else if (item.dataset.section === 'rejected') {
          loadRejectedUsers();
        } else if (item.dataset.section === 'all') {
          loadAllUsers();
        }
      });
    });

    // Update Profile Level Display
    function updateProfileLevelDisplay() {
      if (!currentUserData) return;
      
      const points = currentUserData.points || 0;
      let currentLevel = 1;
      let nextLevelThreshold = levelThresholds[1];
      
      // Determine current level
      for (let i = levelThresholds.length - 1; i >= 0; i--) {
        if (points >= levelThresholds[i]) {
          currentLevel = i + 1;
          nextLevelThreshold = i < levelThresholds.length - 1 ? levelThresholds[i + 1] : levelThresholds[i];
          break;
        }
      }
      
      // Update level display
      levelDisplay.textContent = `Level ${currentLevel}`;
      pointsDisplay.textContent = `${points} Points`;
      
      // Update progress bar
      const progressPercentage = currentLevel < levelThresholds.length 
        ? ((points - levelThresholds[currentLevel - 1]) / (nextLevelThreshold - levelThresholds[currentLevel - 1])) * 100
        : 100;
      progressBar.style.width = `${progressPercentage}%`;
      
      // Update reward achievements
      level1Reward.textContent = points >= levelThresholds[0] ? '✓' : '✗';
      level2Reward.textContent = points >= levelThresholds[1] ? '✓' : '✗';
      level3Reward.textContent = points >= levelThresholds[2] ? '✓' : '✗';
      level4Reward.textContent = points >= levelThresholds[3] ? '✓' : '✗';
      level5Reward.textContent = points >= levelThresholds[4] ? '✓' : '✗';
    }

    // Add points to user
    function addPoints(pointsToAdd, type = 'other', details = '') {
      if (!currentUser || !currentUserData) return;
      
      const currentPoints = currentUserData.points || 0;
      const newPoints = currentPoints + pointsToAdd;
      
      // Update points in database
      database.ref('users/' + currentUser.uid).update({ points: newPoints })
        .then(() => {
          currentUserData.points = newPoints;
          updateProfileLevelDisplay();
          
          // Record the transaction in history
          recordHistory({
            type: type,
            points: pointsToAdd,
            details: details,
            timestamp: firebase.database.ServerValue.TIMESTAMP
          });
        })
        .catch((error) => {
          console.error('Error updating points:', error);
        });
    }

    // Load referral information
    function loadReferralInfo() {
      if (!currentUser || !currentUserData) return;
      
      // Generate referral code from user ID (first 8 characters)
      const referralCode = currentUser.uid.substring(0, 8).toUpperCase();
      referralCodeDisplay.textContent = referralCode;
      
      // Generate referral link
      const referralUrl = `${window.location.origin}${window.location.pathname}?ref=${referralCode}`;
      referralLink.textContent = referralUrl;
      
      // Load referral stats
      database.ref('referrals').orderByChild('referrerId').equalTo(currentUser.uid).once('value')
        .then((snapshot) => {
          let total = 0;
          let pointsEarned = 0;
          
          snapshot.forEach(childSnapshot => {
            const referral = childSnapshot.val();
            total++;
            pointsEarned += referral.pointsEarned || 0;
          });
          
          totalReferrals.textContent = total;
          referralPoints.textContent = pointsEarned;
        });
      
      // Load referral history
      loadReferralHistory();
    }

    // Load referral history
    function loadReferralHistory() {
      if (!currentUser || !currentUserData) return;
      
      database.ref('referrals').orderByChild('referrerId').equalTo(currentUser.uid).once('value')
        .then((snapshot) => {
          referralHistoryList.innerHTML = '';
          
          if (!snapshot.exists()) {
            referralHistoryList.innerHTML = '<div class="history-item">No referral activity yet</div>';
            return;
          }
          
          const referrals = [];
          snapshot.forEach(childSnapshot => {
            referrals.push(childSnapshot.val());
          });
          
          // Sort by timestamp (newest first)
          referrals.sort((a, b) => b.timestamp - a.timestamp);
          
          // Display only the last 5 referrals
          const recentReferrals = referrals.slice(0, 5);
          
          recentReferrals.forEach(ref => {
            const historyItem = document.createElement('div');
            historyItem.className = 'history-item';
            
            const date = new Date(ref.timestamp);
            const dateStr = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
            
            historyItem.innerHTML = `
              <div>Referred: ${ref.referredName || ref.referredEmail}</div>
              <div>Points Earned: ${ref.pointsEarned}</div>
              <div class="date">${dateStr}</div>
            `;
            
            referralHistoryList.appendChild(historyItem);
          });
        });
    }

    // Load user history
    function loadUserHistory() {
      if (!currentUser || !currentUserData) return;
      
      database.ref('history').orderByChild('userId').equalTo(currentUser.uid).once('value')
        .then((snapshot) => {
          historyList.innerHTML = '';
          
          if (!snapshot.exists()) {
            historyList.innerHTML = '<div class="history-entry">No history yet</div>';
            return;
          }
          
          const historyItems = [];
          snapshot.forEach(childSnapshot => {
            historyItems.push(childSnapshot.val());
          });
          
          // Sort by timestamp (newest first)
          historyItems.sort((a, b) => b.timestamp - a.timestamp);
          
          historyItems.forEach(item => {
            const historyEntry = document.createElement('div');
            historyEntry.className = 'history-entry';
            
            const date = new Date(item.timestamp);
            const dateStr = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
            
            historyEntry.innerHTML = `
              <div class="history-type">${getHistoryTypeLabel(item.type)}</div>
              <div class="history-details">${item.details || ''} ${item.points ? `(+${item.points} points)` : ''}</div>
              <div class="history-date">${dateStr}</div>
            `;
            
            historyList.appendChild(historyEntry);
          });
        });
    }

    // Get history type label
    function getHistoryTypeLabel(type) {
      const labels = {
        'referral': 'Referral Bonus',
        'referral_signup': 'Referral Signup',
        'work': 'Work Completed',
        'other': 'Points Added'
      };
      return labels[type] || type;
    }

    // Record history
    function recordHistory(historyData) {
      if (!currentUser || !currentUserData) return;
      
      historyData.userId = currentUser.uid;
      
      database.ref('history').push(historyData)
        .catch(error => {
          console.error('Error recording history:', error);
        });
    }

    // Process referral if any
    function processReferral(referralCode) {
      if (!referralCode || !currentUser || !currentUserData) return;
      
      // Find user with this referral code (first 8 characters of UID)
      database.ref('users').orderByChild('status').equalTo('approved').once('value')
        .then((snapshot) => {
          let referrerId = null;
          let referrerData = null;
          
          snapshot.forEach(childSnapshot => {
            const user = childSnapshot.val();
            if (user.uid.substring(0, 8).toUpperCase() === referralCode.toUpperCase()) {
              referrerId = user.uid;
              referrerData = user;
            }
          });
          
          if (referrerId) {
            // Add referral record
            const referralData = {
              referrerId: referrerId,
              referrerName: referrerData.name,
              referredId: currentUser.uid,
              referredName: currentUserData.name,
              referredEmail: currentUserData.email,
              pointsEarned: REFERRAL_SIGNUP_POINTS,
              timestamp: firebase.database.ServerValue.TIMESTAMP
            };
            
            database.ref('referrals').push(referralData);
            
            // Add points to referrer
            database.ref('users/' + referrerId).once('value')
              .then((userSnapshot) => {
                const referrer = userSnapshot.val();
                const currentPoints = referrer.points || 0;
                const newPoints = currentPoints + REFERRAL_SIGNUP_POINTS;
                
                database.ref('users/' + referrerId).update({ points: newPoints });
                
                // Record history for referrer
                recordHistoryForUser(referrerId, {
                  type: 'referral_signup',
                  points: REFERRAL_SIGNUP_POINTS,
                  details: `New referral: ${currentUserData.name}`,
                  timestamp: firebase.database.ServerValue.TIMESTAMP
                });
              });
          }
        });
    }

    // Check if referred user reached threshold and award bonus
    function checkReferralBonus(userId) {
      database.ref('referrals').orderByChild('referredId').equalTo(userId).once('value')
        .then((snapshot) => {
          snapshot.forEach(childSnapshot => {
            const referral = childSnapshot.val();
            
            // Check if bonus already awarded
            if (!referral.bonusAwarded) {
              database.ref('users/' + userId).once('value')
                .then((userSnapshot) => {
                  const user = userSnapshot.val();
                  
                  if (user.points >= REFERRAL_BONUS_THRESHOLD) {
                    // Award bonus to referrer
                    const currentPoints = user.points || 0;
                    const newPoints = currentPoints + REFERRAL_BONUS_POINTS;
                    
                    database.ref('users/' + referral.referrerId).update({ points: newPoints });
                    
                    // Update referral record
                    database.ref('referrals/' + childSnapshot.key).update({
                      bonusAwarded: true,
                      pointsEarned: referral.pointsEarned + REFERRAL_BONUS_POINTS
                    });
                    
                    // Record history for referrer
                    recordHistoryForUser(referral.referrerId, {
                      type: 'referral',
                      points: REFERRAL_BONUS_POINTS,
                      details: `Referral bonus: ${user.name} reached ${REFERRAL_BONUS_THRESHOLD} points`,
                      timestamp: firebase.database.ServerValue.TIMESTAMP
                    });
                  }
                });
            }
          });
        });
    }

    // Record history for specific user
    function recordHistoryForUser(userId, historyData) {
      historyData.userId = userId;
      
      database.ref('history').push(historyData)
        .catch(error => {
          console.error('Error recording history:', error);
        });
    }

    // Check Auth State
    auth.onAuthStateChanged(user => {
      if (user) {
        // User is signed in
        currentUser = user;
        checkUserStatus(user.uid, user.email);
        
        // Check for referral code in URL
        const urlParams = new URLSearchParams(window.location.search);
        const referralCode = urlParams.get('ref');
        if (referralCode) {
          // Remove referral code from URL
          window.history.replaceState({}, document.title, window.location.pathname);
        }
      } else {
        // No user is signed in
        currentUser = null;
        currentUserData = null;
        showContainer(loginContainer);
      }
    });

    // Login Function
    loginBtn.addEventListener('click', () => {
      const email = loginEmail.value;
      const pass = loginPassword.value;
      
      if (!email || !pass) {
        loginError.textContent = 'Please fill in all fields';
        return;
      }
      
      auth.signInWithEmailAndPassword(email, pass)
        .then((userCredential) => {
          // Login successful
          loginError.textContent = '';
        })
        .catch((error) => {
          loginError.textContent = error.message;
        });
    });

    // Register Function
    registerBtn.addEventListener('click', () => {
      // Validate all fields
      if (!username.value || !name.value || !gender.value || !education.value || 
          !email.value || !password.value || !whatsapp.value || !paymentMethod.value || 
          !paymentNumber.value || !transactionId.value || !datetime.value || !agreeTerms.checked) {
        registerError.textContent = 'Please fill in all fields and agree to terms';
        return;
      }
      
      if (password.value.length < 6) {
        registerError.textContent = 'Password must be at least 6 characters';
        return;
      }
      
      if (paymentNumber.value.length !== 11) {
        registerError.textContent = 'Payment number must be 11 digits';
        return;
      }
      
      // Check for referral code in URL
      const urlParams = new URLSearchParams(window.location.search);
      const urlReferralCode = urlParams.get('ref');
      
      // Use URL referral code if no code was entered in the form
      const referralCode = referral.value || urlReferralCode || '';
      
      // Create user with email and password
      auth.createUserWithEmailAndPassword(email.value, password.value)
        .then((userCredential) => {
          // User created, now save additional info to database
          const user = userCredential.user;
          const userData = {
            username: username.value,
            name: name.value,
            gender: gender.value,
            education: education.value,
            email: email.value,
            whatsapp: whatsapp.value,
            referral: referralCode,
            paymentMethod: paymentMethod.value,
            paymentNumber: paymentNumber.value,
            transactionId: transactionId.value,
            datetime: datetime.value,
            status: 'pending', // pending, approved, rejected
            points: 0, // Initialize points to 0
            createdAt: firebase.database.ServerValue.TIMESTAMP,
            uid: user.uid
          };
          
          // Save user data to database
          database.ref('users/' + user.uid).set(userData)
            .then(() => {
              registerError.textContent = '';
              registerSuccess.textContent = 'Registration successful! Please wait for admin approval.';
              
              // Process referral if any
              if (referralCode) {
                processReferral(referralCode);
              }
              
              // Clear form
              username.value = '';
              name.value = '';
              gender.value = '';
              education.value = '';
              email.value = '';
              password.value = '';
              whatsapp.value = '';
              referral.value = '';
              paymentMethod.value = '';
              paymentNumber.value = '';
              transactionId.value = '';
              datetime.value = '';
              agreeTerms.checked = false;
              
              // Show pending approval screen
              setTimeout(() => {
                showContainer(pendingContainer);
                auth.signOut(); // Logout user until approved
              }, 2000);
            })
            .catch((error) => {
              registerError.textContent = 'Failed to save user data: ' + error.message;
            });
        })
        .catch((error) => {
          registerError.textContent = error.message;
        });
    });

    // Check User Status (pending, approved, admin)
    function checkUserStatus(uid, email) {
      database.ref('users/' + uid).once('value')
        .then((snapshot) => {
          const userData = snapshot.val();
          currentUserData = userData;
          
          // Check if admin
          if (adminEmails.includes(email)) {
            showAdminPanel();
            loadAdminStats();
            loadPendingUsers();
            return;
          }
          
          // Check if user exists and is approved
          if (userData && userData.status === 'approved') {
            // Show dashboard
            showDashboard(userData);
            
            // Check if user reached referral bonus threshold
            checkReferralBonus(uid);
          } else if (userData && userData.status === 'pending') {
            // Show pending approval screen
            showContainer(pendingContainer);
          } else {
            // User data not found or status unknown
            auth.signOut();
            showContainer(loginContainer);
          }
        })
        .catch((error) => {
          console.error('Error checking user status:', error);
          auth.signOut();
          showContainer(loginContainer);
        });
    }

    // Show Dashboard
    function showDashboard(userData) {
      dashboardUsername.textContent = `Welcome, ${userData.username}`;
      showContainer(dashboardContainer);
      
      // For testing - add some points automatically
      // setTimeout(() => addPoints(15, 'work', 'Completed test task'), 2000); // Add 15 points after 2 seconds (for testing)
    }

    // Show Admin Panel
    function showAdminPanel() {
      showContainer(adminDashboard);
      loadAdminStats();
      loadPendingUsers();
    }

    // Load Admin Stats
    function loadAdminStats() {
      database.ref('users').once('value')
        .then((snapshot) => {
          let total = 0;
          let pending = 0;
          let approved = 0;
          let rejected = 0;
          
          snapshot.forEach(childSnapshot => {
            const user = childSnapshot.val();
            total++;
            if (user.status === 'pending') pending++;
            if (user.status === 'approved') approved++;
            if (user.status === 'rejected') rejected++;
          });
          
          totalUsersEl.textContent = total;
          pendingUsersEl.textContent = pending;
          approvedUsersEl.textContent = approved;
        })
        .catch((error) => {
          console.error('Error loading admin stats:', error);
        });
    }

    // Load Pending Users
    function loadPendingUsers() {
      database.ref('users').orderByChild('status').equalTo('pending').once('value')
        .then((snapshot) => {
          pendingList.innerHTML = '';
          
          if (!snapshot.exists()) {
            pendingList.innerHTML = '<p>No pending users</p>';
            return;
          }
          
          snapshot.forEach((childSnapshot) => {
            const user = childSnapshot.val();
            addUserCard(user, pendingList, true);
          });
        })
        .catch((error) => {
          console.error('Error loading pending users:', error);
        });
    }

    // Load Approved Users
    function loadApprovedUsers() {
      database.ref('users').orderByChild('status').equalTo('approved').once('value')
        .then((snapshot) => {
          approvedList.innerHTML = '';
          
          if (!snapshot.exists()) {
            approvedList.innerHTML = '<p>No approved users</p>';
            return;
          }
          
          snapshot.forEach((childSnapshot) => {
            const user = childSnapshot.val();
            addUserCard(user, approvedList, false);
          });
        })
        .catch((error) => {
          console.error('Error loading approved users:', error);
        });
    }

    // Load Rejected Users
    function loadRejectedUsers() {
      database.ref('users').orderByChild('status').equalTo('rejected').once('value')
        .then((snapshot) => {
          rejectedList.innerHTML = '';
          
          if (!snapshot.exists()) {
            rejectedList.innerHTML = '<p>No rejected users</p>';
            return;
          }
          
          snapshot.forEach((childSnapshot) => {
            const user = childSnapshot.val();
            addUserCard(user, rejectedList, false);
          });
        })
        .catch((error) => {
          console.error('Error loading rejected users:', error);
        });
    }

    // Load All Users
    function loadAllUsers() {
      database.ref('users').once('value')
        .then((snapshot) => {
          allList.innerHTML = '';
          
          if (!snapshot.exists()) {
            allList.innerHTML = '<p>No users found</p>';
            return;
          }
          
          snapshot.forEach((childSnapshot) => {
            const user = childSnapshot.val();
            addUserCard(user, allList, user.status === 'pending');
          });
        })
        .catch((error) => {
          console.error('Error loading all users:', error);
        });
    }

    // Add User Card to List
    function addUserCard(user, listElement, showActions = true) {
      const userCard = document.createElement('div');
      userCard.className = 'user-card';
      
      const statusClass = user.status === 'pending' ? 'pending' : 
                         user.status === 'approved' ? 'approved' : 'rejected';
      
      userCard.innerHTML = `
        <div class="user-info">
          <div class="user-name">${user.name} (${user.username})</div>
          <div class="user-email">${user.email}</div>
          <div class="user-whatsapp">WhatsApp: ${user.whatsapp}</div>
          <div class="user-payment">Payment: ${user.paymentMethod} (${user.paymentNumber})</div>
          <div class="user-status ${statusClass}">${user.status}</div>
          <div class="user-points">Points: ${user.points || 0}</div>
        </div>
      `;
      
      if (showActions) {
        const actionButtons = document.createElement('div');
        actionButtons.className = 'action-buttons';
        actionButtons.innerHTML = `
          <button class="action-btn approve-btn" data-uid="${user.uid}">Approve</button>
          <button class="action-btn reject-btn" data-uid="${user.uid}">Reject</button>
          <button class="action-btn view-btn" data-uid="${user.uid}">View</button>
        `;
        userCard.appendChild(actionButtons);
        
        // Add event listeners to buttons
        userCard.querySelector('.approve-btn').addEventListener('click', () => approveUser(user.uid));
        userCard.querySelector('.reject-btn').addEventListener('click', () => rejectUser(user.uid));
        userCard.querySelector('.view-btn').addEventListener('click', () => viewUser(user));
      }
      
      listElement.appendChild(userCard);
    }

    // Approve User
    function approveUser(uid) {
      database.ref('users/' + uid).update({ status: 'approved' })
        .then(() => {
          // Refresh all lists and stats
          loadPendingUsers();
          loadApprovedUsers();
          loadAllUsers();
          loadAdminStats();
        })
        .catch((error) => {
          console.error('Error approving user:', error);
        });
    }

    // Reject User
    function rejectUser(uid) {
      database.ref('users/' + uid).update({ status: 'rejected' })
        .then(() => {
          // Refresh all lists and stats
          loadPendingUsers();
          loadRejectedUsers();
          loadAllUsers();
          loadAdminStats();
        })
        .catch((error) => {
          console.error('Error rejecting user:', error);
        });
    }

    // View User Details
    function viewUser(user) {
      alert(`User Details:\n\nName: ${user.name}\nUsername: ${user.username}\nEmail: ${user.email}\nWhatsApp: ${user.whatsapp}\nStatus: ${user.status}\nPoints: ${user.points || 0}\nPayment Method: ${user.paymentMethod}\nPayment Number: ${user.paymentNumber}\nTransaction ID: ${user.transactionId}\nRegistration Date: ${new Date(user.datetime).toLocaleString()}`);
    }

    // Logout Function
    function logout() {
      auth.signOut()
        .then(() => {
          showContainer(loginContainer);
        })
        .catch((error) => {
          console.error('Error logging out:', error);
        });
    }

    // Initialize - show login by default
    showContainer(loginContainer);
    
    // Set current datetime for registration form
    const now = new Date();
    datetime.value = now.toISOString().slice(0, 16);
  </script>
</body>
</html>
